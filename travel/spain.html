<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>西班牙夏日日食之旅 2026</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
        }
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1; 
        }
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8; 
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .eclipse-gradient {
            background: linear-gradient(135deg, #0f172a 0%, #312e81 100%);
        }

        /* Card Hover Effect */
        .attraction-card:hover {
            transform: translateY(-5px);
        }

        /* Carousel Styles */
        .carousel-track {
            display: flex;
            transition: transform 0.5s ease-in-out;
            height: 100%;
        }
        .carousel-slide {
            min-width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
        }
        .carousel-overlay {
            background: linear-gradient(to top, rgba(0,0,0,0.8) 0%, transparent 40%);
        }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        spain: {
                            red: '#AA151B',
                            yellow: '#F1BF00',
                            dark: '#1e293b'
                        }
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-gray-50 text-slate-800 h-screen flex overflow-hidden">

    <!-- Mobile Menu Button (Visible only on small screens) -->
    <button id="mobile-menu-btn" class="fixed top-4 left-4 z-50 p-2 bg-spain-red text-white rounded-lg shadow-lg md:hidden">
        <i class="fas fa-bars"></i>
    </button>

    <!-- Sidebar Navigation -->
    <aside id="sidebar" class="bg-slate-900 text-white w-64 flex-shrink-0 h-full flex flex-col transition-transform transform -translate-x-full md:translate-x-0 absolute md:relative z-40">
        <div class="p-6 bg-spain-red flex items-center justify-between">
            <h1 class="text-xl font-bold tracking-wider"><i class="fas fa-sun mr-2 text-spain-yellow"></i>西班牙之旅</h1>
            <button id="close-sidebar" class="md:hidden text-white"><i class="fas fa-times"></i></button>
        </div>

        <nav class="flex-1 overflow-y-auto py-4">
            <ul id="city-list" class="space-y-1">
                <!-- City and Attractions will be injected here via JS -->
            </ul>
        </nav>

        <div class="p-4 bg-slate-800 text-xs text-slate-400 text-center border-t border-slate-700">
            <p>2026 夏日特別企劃</p>
            <p>Seville • Madrid • Barcelona • Valencia</p>
        </div>
    </aside>

    <!-- Main Content Area -->
    <main class="flex-1 h-full overflow-y-auto relative w-full" id="main-content-area">
        <!-- Top Header -->
        <header class="bg-white shadow-sm sticky top-0 z-30 px-8 py-4 flex justify-between items-center pl-16 md:pl-8">
            <div>
                <h2 id="header-title" class="text-2xl font-bold text-slate-800">歡迎開始旅程</h2>
                <p id="header-subtitle" class="text-sm text-slate-500">請從左側選擇城市與景點</p>
            </div>
            <div class="hidden sm:block">
                <span class="bg-orange-100 text-orange-800 text-xs font-medium px-2.5 py-0.5 rounded border border-orange-200">7月尾 - 8月中</span>
            </div>
        </header>

        <!-- Dynamic Content Container -->
        <div id="content-container" class="p-4 md:p-8 max-w-7xl mx-auto min-h-[calc(100vh-80px)]">
            <!-- Initial Welcome State -->
            <div class="flex flex-col items-center justify-center h-[60vh] text-center text-slate-400">
                <i class="fas fa-map-location-dot text-6xl mb-4 text-slate-300"></i>
                <h3 class="text-xl font-medium">選擇左側選單開始規劃您的西班牙之旅</h3>
                <p class="mt-2 text-sm">包含 Sevilla, Madrid, Barcelona 及 Valencia 日全食攻略</p>
            </div>
        </div>
    </main>

    <!-- Javascript Logic -->
    <script>
        // Data Structure
        const tripData = [
            {
                id: 'seville',
                name: 'Seville 西維爾',
                icon: 'fa-fan', 
                cityMapQuery: 'tourist attractions in Seville, Spain',
                attractions: [
                    {
                        id: 'alcazar',
                        name: '塞維亞王宮 (Real Alcázar)',
                        image: 'https://images.unsplash.com/photo-1559563351-24b58e653ee4?q=80&w=1000&auto=format&fit=crop',
                        description: '歐洲最古老的皇家宮殿之一，融合了伊斯蘭、哥德式和文藝復興風格。這裡也是《權力遊戲》多恩王國的取景地。',
                        address: 'Patio de Banderas, s/n, 41004 Sevilla',
                        transport: '路面電車 T1 線到達 Archivo de Indias 站。',
                        price: '一般 €13.50 / 導覽機 +€6',
                        hours: '09:30 - 19:00 (每日)',
                        mapQuery: 'Real Alcázar of Seville'
                    },
                    {
                        id: 'plaza-espana',
                        name: '西班牙廣場 (Plaza de España)',
                        image: 'https://images.unsplash.com/photo-1542665174-31db64d7e0e4?q=80&w=1000&auto=format&fit=crop',
                        description: '1929年伊比利亞-美洲博覽會的中心建築，半圓形的紅磚建築環繞著運河，您可以租小船划行。',
                        address: 'Av. de Isabel la Católica, 41004 Sevilla',
                        transport: '公車 34, C1 到達 Avda. María Luisa。',
                        price: '免費入場',
                        hours: '24小時開放',
                        mapQuery: 'Plaza de España Seville'
                    },
                    {
                        id: 'catedral',
                        name: '塞維亞主教座堂與吉拉達塔',
                        image: 'https://images.unsplash.com/photo-1554067219-482a8d5045f8?q=80&w=1000&auto=format&fit=crop',
                        description: '世界最大的哥德式教堂，擁有哥倫布的靈柩。吉拉達塔（Giralda）原為清真寺宣禮塔，登頂可俯瞰全市。',
                        address: 'Av. de la Constitución, s/n, 41004 Sevilla',
                        transport: '路面電車 T1 至 Archivo de Indias。',
                        price: '約 €11 (包含登塔)',
                        hours: '10:45 - 17:00 (週日 14:30 開放)',
                        mapQuery: 'Catedral de Sevilla'
                    },
                    {
                        id: 'setas',
                        name: '都市陽傘 (Setas de Sevilla)',
                        image: 'https://images.unsplash.com/photo-1563216654-20b15b395646?q=80&w=1000&auto=format&fit=crop',
                        description: '世界最大的木造建築，外型如巨大蘑菇。擁有絕佳的觀景步道，日落時分景色最美。',
                        address: 'Pl. de la Encarnación, s/n, 41003 Sevilla',
                        transport: '公車 27, 32 號至 Plaza del Duque。',
                        price: '日間 €5 / 晚間 €10',
                        hours: '09:30 - 00:00',
                        mapQuery: 'Setas de Sevilla'
                    },
                    {
                        id: 'torre-oro',
                        name: '黃金塔 (Torre del Oro)',
                        image: 'https://images.unsplash.com/photo-1561730032-15f9e30a5762?q=80&w=1000&auto=format&fit=crop',
                        description: '位於瓜達基維河畔的軍事瞭望塔，曾貼滿金色瓷磚而得名。現為海軍博物館。',
                        address: 'Paseo de Cristóbal Colón, s/n, 41001 Sevilla',
                        transport: '地鐵 L1 至 Puerta de Jerez。',
                        price: '€3 (週一免費)',
                        hours: '09:30 - 18:45',
                        mapQuery: 'Torre del Oro Seville'
                    },
                    {
                        id: 'barrio-santa-cruz',
                        name: '聖十字區 (Barrio de Santa Cruz)',
                        image: 'https://images.unsplash.com/photo-1558088424-9f2d11db8453?q=80&w=1000&auto=format&fit=crop',
                        description: '舊猶太區，充滿迷宮般的狹窄街道、白色房屋和隱藏的庭院，是散步和吃 Tapas 的最佳地點。',
                        address: 'Barrio de Santa Cruz, Sevilla',
                        transport: '步行 (位於大教堂旁)',
                        price: '免費',
                        hours: '24小時開放',
                        mapQuery: 'Barrio de Santa Cruz Seville'
                    },
                    {
                        id: 'casa-pilatos',
                        name: '彼拉多官邸 (Casa de Pilatos)',
                        image: 'https://images.unsplash.com/photo-1620764720999-e93233261763?q=80&w=1000&auto=format&fit=crop',
                        description: '被認為是塞維亞最美的安達盧西亞宮殿，結合了文藝復興和穆德哈爾風格，磁磚裝飾極為精美。',
                        address: 'Pl. de Pilatos, 1, 41003 Sevilla',
                        transport: '公車 C3, C4 至 Puerta Carmona。',
                        price: '€10 - €12',
                        hours: '09:00 - 18:00',
                        mapQuery: 'Casa de Pilatos'
                    },
                    {
                        id: 'triana',
                        name: '特里亞納區與市場 (Triana)',
                        image: 'https://images.unsplash.com/photo-1647466548769-3467406a0665?q=80&w=1000&auto=format&fit=crop',
                        description: '過河後的陶器與佛朗明哥發源地。必訪特里亞納市場品嚐美食，感受地道生活氣息。',
                        address: 'C. de San Jorge, 6, 41010 Sevilla',
                        transport: '過 Isabel II 橋 (Triana Bridge)。',
                        price: '免費',
                        hours: '市場 09:00 - 15:00',
                        mapQuery: 'Mercado de Triana'
                    },
                    {
                        id: 'maria-luisa',
                        name: '瑪麗亞路易莎公園',
                        image: 'https://images.unsplash.com/photo-1574627198942-1cb66d6a2f4c?q=80&w=1000&auto=format&fit=crop',
                        description: '塞維亞最大的綠肺，緊鄰西班牙廣場，擁有豐富的植物園、噴泉和涼亭，夏天避暑好去處。',
                        address: 'P.º de las Delicias, s/n, 41013 Sevilla',
                        transport: '公車 34, C1。',
                        price: '免費',
                        hours: '08:00 - 22:00',
                        mapQuery: 'Parque de María Luisa'
                    },
                    {
                        id: 'maestranza',
                        name: '皇家騎士鬥牛場',
                        image: 'https://images.unsplash.com/photo-1583313264908-0f1d39281517?q=80&w=1000&auto=format&fit=crop',
                        description: '西班牙最古老且最重要的鬥牛場之一。即使不看鬥牛，參觀博物館和建築本身也非常值得。',
                        address: 'P.º de Cristóbal Colón, 12, 41001 Sevilla',
                        transport: '地鐵 L1 至 Puerta de Jerez。',
                        price: '€10 (導覽)',
                        hours: '09:30 - 19:30',
                        mapQuery: 'Plaza de Toros de la Maestranza'
                    }
                ]
            },
            {
                id: 'madrid',
                name: 'Madrid 馬德里',
                icon: 'fa-crown',
                cityMapQuery: 'tourist attractions in Madrid, Spain',
                attractions: [
                    {
                        id: 'prado',
                        name: '普拉多博物館 (Museo del Prado)',
                        image: 'https://images.unsplash.com/photo-1549467798-232f01f2f392?q=80&w=1000&auto=format&fit=crop',
                        description: '世界頂級博物館之一，收藏了哥雅、委拉斯開茲等大師的傑作，是藝術愛好者的必訪之地。',
                        address: 'C. de Ruiz de Alarcón, 23, 28014 Madrid',
                        transport: '地鐵 1 號線 Atocha 站。',
                        price: '一般 €15 (每日最後2小時免費)',
                        hours: '10:00 - 20:00',
                        mapQuery: 'Museo Nacional del Prado'
                    },
                    {
                        id: 'royal-palace',
                        name: '馬德里王宮 (Palacio Real)',
                        image: 'https://images.unsplash.com/photo-1544908992-66a7b7495004?q=80&w=1000&auto=format&fit=crop',
                        description: '西歐最大的皇宮，擁有超過3000個房間。雖然國王不住在這裡，但仍用於國事活動。',
                        address: 'C. de Bailén, s/n, 28071 Madrid',
                        transport: '地鐵 2/5 號線 Ópera 站。',
                        price: '一般 €12',
                        hours: '10:00 - 19:00',
                        mapQuery: 'Royal Palace of Madrid'
                    },
                    {
                        id: 'retiro',
                        name: '麗池公園 (El Retiro)',
                        image: 'https://images.unsplash.com/photo-1570701564993-e00652af8aa7?q=80&w=1000&auto=format&fit=crop',
                        description: '馬德里的中央公園，必看水晶宮 (Palacio de Cristal) 和在人工湖上划船。',
                        address: 'Plaza de la Independencia, 7, 28001 Madrid',
                        transport: '地鐵 2 號線 Retiro 站。',
                        price: '免費',
                        hours: '06:00 - 00:00 (夏季)',
                        mapQuery: 'El Retiro Park'
                    },
                    {
                        id: 'plaza-mayor',
                        name: '馬約爾廣場 (Plaza Mayor)',
                        image: 'https://images.unsplash.com/photo-1621523586616-2410a7281f66?q=80&w=1000&auto=format&fit=crop',
                        description: '這座宏偉的廣場見證了馬德里的歷史。周圍有許多傳統餐廳，必吃「魷魚三明治」。',
                        address: 'Plaza Mayor, 28012 Madrid',
                        transport: '地鐵 1/2/3 號線 Sol 站。',
                        price: '免費',
                        hours: '24小時開放',
                        mapQuery: 'Plaza Mayor Madrid'
                    },
                    {
                        id: 'reina-sofia',
                        name: '索菲亞王后藝術中心',
                        image: 'https://images.unsplash.com/photo-1580131433240-a337424d8689?q=80&w=1000&auto=format&fit=crop',
                        description: '現代藝術博物館，鎮館之寶是畢卡索的《格爾尼卡》(Guernica) 以及達利的作品。',
                        address: 'C. de Santa Isabel, 52, 28012 Madrid',
                        transport: '地鐵 1 號線 Atocha 站。',
                        price: '€12 (部分時段免費)',
                        hours: '10:00 - 21:00 (週二休館)',
                        mapQuery: 'Museo Nacional Centro de Arte Reina Sofía'
                    },
                    {
                        id: 'debod',
                        name: '德波神廟 (Templo de Debod)',
                        image: 'https://images.unsplash.com/photo-1548100523-2884a2c07929?q=80&w=1000&auto=format&fit=crop',
                        description: '埃及政府贈送給西班牙的古埃及神廟，這裡是觀賞馬德里日落的最佳地點之一。',
                        address: 'C. de Ferraz, 1, 28008 Madrid',
                        transport: '地鐵 3/10 號線 Plaza de España 站。',
                        price: '免費',
                        hours: '10:00 - 19:00 (週一休館)',
                        mapQuery: 'Temple of Debod'
                    },
                    {
                        id: 'mercado-san-miguel',
                        name: '聖米格爾市場',
                        image: 'https://images.unsplash.com/photo-1576615278792-741c305a4209?q=80&w=1000&auto=format&fit=crop',
                        description: '著名的鋼鐵結構美食市場，匯集了各式各樣的高級 Tapas、海鮮和美酒。',
                        address: 'Pl. de San Miguel, s/n, 28005 Madrid',
                        transport: '步行 (近 Plaza Mayor)。',
                        price: '免費入場',
                        hours: '10:00 - 00:00',
                        mapQuery: 'Mercado de San Miguel'
                    },
                    {
                        id: 'bernabeu',
                        name: '聖地亞哥·伯納烏球場',
                        image: 'https://images.unsplash.com/photo-1557602330-0e7740e2c040?q=80&w=1000&auto=format&fit=crop',
                        description: '皇家馬德里的主場。足球迷必參加的球場導覽，參觀更衣室、獎盃室和球場草皮。',
                        address: 'Av. de Concha Espina, 1, 28036 Madrid',
                        transport: '地鐵 10 號線 Santiago Bernabéu 站。',
                        price: '約 €25 (導覽)',
                        hours: '09:30 - 19:00',
                        mapQuery: 'Santiago Bernabéu Stadium'
                    },
                    {
                        id: 'gran-via',
                        name: '格蘭大道 (Gran Vía)',
                        image: 'https://images.unsplash.com/photo-1512453979798-5ea9ba6a80f4?q=80&w=1000&auto=format&fit=crop',
                        description: '馬德里的百老匯，聚集了劇院、購物中心和宏偉的建築，是購物和看音樂劇的中心。',
                        address: 'Gran Vía, Madrid',
                        transport: '地鐵 1/5 號線 Gran Vía 站。',
                        price: '免費',
                        hours: '24小時開放',
                        mapQuery: 'Gran Vía Madrid'
                    },
                    {
                        id: 'puerta-sol',
                        name: '太陽門廣場 (Puerta del Sol)',
                        image: 'https://images.unsplash.com/photo-1575806307185-3e2888636b0f?q=80&w=1000&auto=format&fit=crop',
                        description: '西班牙的中心點 (0公里標誌)，必拍「熊與草莓樹」雕像，也是跨年倒數的地方。',
                        address: 'Puerta del Sol, 28013 Madrid',
                        transport: '地鐵 1/2/3 號線 Sol 站。',
                        price: '免費',
                        hours: '24小時開放',
                        mapQuery: 'Puerta del Sol'
                    }
                ]
            },
            {
                id: 'barcelona',
                name: 'Barcelona 巴塞羅那',
                icon: 'fa-building',
                cityMapQuery: 'tourist attractions in Barcelona, Spain',
                attractions: [
                    {
                        id: 'sagrada',
                        name: '聖家堂 (Sagrada Família)',
                        image: 'https://images.unsplash.com/photo-1523531294919-4bcd7c65e216?q=80&w=1000&auto=format&fit=crop',
                        description: '高第的畢生傑作，這座未完工的教堂融合了自然元素與神聖幾何，光影效果令人震撼。',
                        address: 'C/ de Mallorca, 401, 08013 Barcelona',
                        transport: '地鐵 L2/L5 Sagrada Família 站。',
                        price: '€26 / 登塔 €36 (需預約)',
                        hours: '09:00 - 20:00',
                        mapQuery: 'La Sagrada Familia'
                    },
                    {
                        id: 'park-guell',
                        name: '奎爾公園 (Park Güell)',
                        image: 'https://images.unsplash.com/photo-1601633544778-941e7f6770f5?q=80&w=1000&auto=format&fit=crop',
                        description: '色彩斑斕的馬賽克蜥蜴和蜿蜒的長椅，這裡是俯瞰巴塞羅那全景的最佳地點之一。',
                        address: '08024 Barcelona',
                        transport: '公車 24/116 號 (直達入口)。',
                        price: '一般 €10',
                        hours: '09:30 - 19:30',
                        mapQuery: 'Park Güell'
                    },
                    {
                        id: 'casa-batllo',
                        name: '巴特略之家 (Casa Batlló)',
                        image: 'https://images.unsplash.com/photo-1569333333155-27694f6f4d89?q=80&w=1000&auto=format&fit=crop',
                        description: '高第的魔幻建築，外牆如同龍鱗，內部沒有直線。夏季有舉辦屋頂音樂會。',
                        address: 'Pg. de Gràcia, 43, 08007 Barcelona',
                        transport: '地鐵 L2/L3/L4 Pg de Gràcia 站。',
                        price: '€35 起',
                        hours: '09:00 - 20:00',
                        mapQuery: 'Casa Batlló'
                    },
                    {
                        id: 'casa-mila',
                        name: '米拉之家 (La Pedrera)',
                        image: 'https://images.unsplash.com/photo-1538333581680-29dd47526f2d?q=80&w=1000&auto=format&fit=crop',
                        description: '高第設計的最後一個私人住宅，以其波浪形石材外觀和著名的屋頂士兵煙囪聞名。',
                        address: 'Pg. de Gràcia, 92, 08008 Barcelona',
                        transport: '地鐵 L3/L5 Diagonal 站。',
                        price: '€25',
                        hours: '09:00 - 20:30',
                        mapQuery: 'Casa Milà'
                    },
                    {
                        id: 'la-boqueria',
                        name: '博蓋利亞市場與蘭布拉大道',
                        image: 'https://images.unsplash.com/photo-1629831968840-78155e81cb8d?q=80&w=1000&auto=format&fit=crop',
                        description: '在熱鬧的蘭布拉大道旁，這個市場是美食天堂。必喝新鮮果汁和吃火腿。',
                        address: 'La Rambla, 91, 08001 Barcelona',
                        transport: '地鐵 L3 Liceu 站。',
                        price: '免費入場',
                        hours: '08:00 - 20:30 (週日休)',
                        mapQuery: 'Mercado de La Boqueria'
                    },
                    {
                        id: 'gothic-quarter',
                        name: '哥德區 (Barri Gòtic)',
                        image: 'https://images.unsplash.com/photo-1579282240050-352db0a14c21?q=80&w=1000&auto=format&fit=crop',
                        description: '巴塞隆納最古老的城區，擁有羅馬遺跡和中世紀大教堂。穿梭在巷弄間彷彿時光倒流。',
                        address: 'Barri Gòtic, Barcelona',
                        transport: '地鐵 L4 Jaume I 站。',
                        price: '免費',
                        hours: '24小時開放',
                        mapQuery: 'Gothic Quarter Barcelona'
                    },
                    {
                        id: 'barceloneta',
                        name: '巴塞羅內塔海灘',
                        image: 'https://images.unsplash.com/photo-1562184552-e2a10c7520e0?q=80&w=1000&auto=format&fit=crop',
                        description: '市區最受歡迎的海灘，夏日必去。可以在沙灘酒吧 (Chiringuitos) 享用海鮮飯。',
                        address: 'Paseo Marítimo de la Barceloneta',
                        transport: '地鐵 L4 Barceloneta 站。',
                        price: '免費',
                        hours: '24小時開放',
                        mapQuery: 'Barceloneta Beach'
                    },
                    {
                        id: 'montjuic',
                        name: '蒙特惠奇山與魔幻噴泉',
                        image: 'https://images.unsplash.com/photo-1549487779-71775837651c?q=80&w=1000&auto=format&fit=crop',
                        description: '俯瞰城市的山丘，擁有國家宮美術館。魔幻噴泉在夜晚會有音樂燈光秀 (需查時刻表)。',
                        address: 'Pl. de Carles Buïgas, 1, 08038 Barcelona',
                        transport: '地鐵 L1/L3 Espanya 站。',
                        price: '免費 (美術館需門票)',
                        hours: '噴泉秀通常在週末晚間',
                        mapQuery: 'Magic Fountain of Montjuïc'
                    },
                    {
                        id: 'camp-nou',
                        name: '諾坎普球場 (Camp Nou)',
                        image: 'https://images.unsplash.com/photo-1616110300184-2a6d4791e847?q=80&w=1000&auto=format&fit=crop',
                        description: '巴塞隆納足球俱樂部主場，歐洲最大體育場。注意：目前正在翻修中，博物館仍開放。',
                        address: 'C. d\'Arístides Maillol, 12, 08028 Barcelona',
                        transport: '地鐵 L3 Palau Reial 站。',
                        price: '約 €28 (博物館)',
                        hours: '09:30 - 19:30',
                        mapQuery: 'Spotify Camp Nou'
                    },
                    {
                        id: 'picasso',
                        name: '畢卡索美術館',
                        image: 'https://images.unsplash.com/photo-1595304627195-24e5287e07e8?q=80&w=1000&auto=format&fit=crop',
                        description: '收藏了大量畢卡索早期的作品，設於五座相連的中世紀宮殿內，非常有氛圍。',
                        address: 'C/ de Montcada, 15-23, 08003 Barcelona',
                        transport: '地鐵 L4 Jaume I 站。',
                        price: '€12 (週四下午免費)',
                        hours: '10:00 - 19:00 (週一休)',
                        mapQuery: 'Picasso Museum Barcelona'
                    }
                ]
            },
            {
                id: 'valencia',
                name: 'Valencia 華倫西亞',
                icon: 'fa-sun',
                cityMapQuery: 'tourist attractions in Valencia, Spain',
                attractions: [
                    {
                        id: 'arts-science',
                        name: '藝術科學城 (City of Arts and Sciences)',
                        image: 'https://images.unsplash.com/photo-1473979782782-2735165c4004?q=80&w=1000&auto=format&fit=crop',
                        description: '充滿未來感的建築群，包含水族館、科學博物館和歌劇院，是華倫西亞的地標。',
                        address: 'Av. del Professor López Piñero, 7, 46013 València',
                        transport: '公車 1, 13, 15, 19, 25, 35, 40 號。',
                        price: '套票約 €38',
                        hours: '10:00 - 21:00',
                        mapQuery: 'City of Arts and Sciences Valencia'
                    },
                    {
                        id: 'eclipse-2026',
                        name: '⭐ 2026 日全食觀測 (重要活動)',
                        type: 'special',
                        image: 'https://images.unsplash.com/photo-1478760329108-5c3ed9d495a0?q=80&w=1000&auto=format&fit=crop',
                        description: '本次旅程的重頭戲。由於全食發生時太陽極為接近地平線（仰角僅約 6-10 度），為了避免視野遮擋，我們安排前往 Sagunto 的制高點古堡遺跡。',
                        date: '2026年8月12日 (星期三)',
                        time: '19:35 開始偏食，20:30 全食',
                        location: 'Castillo de Sagunto (薩貢托城堡) - 山頂遺跡',
                        direction: '西方/西北方',
                        tips: [
                            '高地優勢：城堡位於山頂，西方視野完全無遮擋。',
                            '必須佩戴專業日食眼鏡，肉眼不可直視。',
                            '建議下午 16:00 前到達佔據西面城牆位置。',
                            '全食階段氣溫會驟降，且天色變暗如黑夜。'
                        ]
                    },
                    {
                        id: 'lonja',
                        name: '絲綢交易所 (La Lonja de la Seda)',
                        image: 'https://images.unsplash.com/photo-1598460616854-3b2d18442e18?q=80&w=1000&auto=format&fit=crop',
                        description: '聯合國教科文組織世界遺產，哥德式世俗建築的傑作，內部螺旋柱大廳令人驚嘆。',
                        address: 'C/ de la Llotja, 2, 46001 València',
                        transport: '步行 (位於中央市場對面)。',
                        price: '€2 (週日免費)',
                        hours: '10:00 - 19:00',
                        mapQuery: 'La Lonja de la Seda'
                    },
                    {
                        id: 'mercado-central',
                        name: '中央市場 (Mercado Central)',
                        image: 'https://images.unsplash.com/photo-1518182170546-0766ce6fec93?q=80&w=1000&auto=format&fit=crop',
                        description: '歐洲最大最古老的市場之一，現代主義風格建築。在這裡可以買到最新鮮的華倫西亞橙子和海鮮。',
                        address: 'Pl. de la Ciutat de Bruges, s/n, 46001 València',
                        transport: '公車 7, 27, 73。',
                        price: '免費入場',
                        hours: '07:30 - 15:00 (週日休)',
                        mapQuery: 'Mercado Central Valencia'
                    },
                    {
                        id: 'valencia-cathedral',
                        name: '華倫西亞主教座堂與聖杯',
                        image: 'https://images.unsplash.com/photo-1563299796-b729d0af54a5?q=80&w=1000&auto=format&fit=crop',
                        description: '據說耶穌最後晚餐使用的聖杯就收藏於此。可登上米格雷特塔 (Miguelete) 俯瞰城市。',
                        address: 'Pl. de l\'Almoina, s/n, 46003 València',
                        transport: '公車 4, 6, 8, 9, 11, 16, 28。',
                        price: '€9 (含語音導覽)',
                        hours: '10:30 - 18:30',
                        mapQuery: 'Valencia Cathedral'
                    },
                    {
                        id: 'bioparc',
                        name: '華倫西亞生物園 (Bioparc)',
                        image: 'https://images.unsplash.com/photo-1547970810-dc1eac37d174?q=80&w=1000&auto=format&fit=crop',
                        description: '沉浸式動物園，以「動物地理學」設計，沒有明顯的柵欄，彷彿置身非洲大草原。',
                        address: 'Av. Pío Baroja, 3, 46015 València',
                        transport: '公車 98, 99。',
                        price: '€26.90',
                        hours: '10:00 - 20:00',
                        mapQuery: 'Bioparc Valencia'
                    },
                    {
                        id: 'turia-gardens',
                        name: '圖里亞花園 (Jardín del Turia)',
                        image: 'https://images.unsplash.com/photo-1596485806653-731362d2a44e?q=80&w=1000&auto=format&fit=crop',
                        description: '由乾涸河床改建而成的長條形公園，橫跨整個城市，適合騎自行車或散步。',
                        address: '貫穿市中心',
                        transport: '多個入口。',
                        price: '免費',
                        hours: '24小時開放',
                        mapQuery: 'Jardín del Turia'
                    },
                    {
                        id: 'albufera',
                        name: '阿爾布費拉自然公園',
                        image: 'https://images.unsplash.com/photo-1569399472304-4b52c00cc1f7?q=80&w=1000&auto=format&fit=crop',
                        description: '位於市郊的淡水潟湖，是西班牙海鮮飯 (Paella) 的發源地。必搭遊船看日落。',
                        address: 'València (市中心以南10公里)',
                        transport: '公車 24, 25 號 (約45分鐘)。',
                        price: '遊船約 €5',
                        hours: '全天 (建議傍晚)',
                        mapQuery: 'Parque Natural de la Albufera'
                    },
                    {
                        id: 'torres-serranos',
                        name: '塞拉諾斯塔 (Torres de Serranos)',
                        image: 'https://images.unsplash.com/photo-1545663738-902e4871bd50?q=80&w=1000&auto=format&fit=crop',
                        description: '古城牆遺留下的哥德式城門，曾作為監獄。登上塔頂可以欣賞城市和圖里亞花園的美景。',
                        address: 'Plaza de los Fueros, s/n, 46003 València',
                        transport: '公車 C1, 6, 11, 16, 26, 28。',
                        price: '€2 (週日免費)',
                        hours: '10:00 - 19:00 (週一休)',
                        mapQuery: 'Torres de Serranos'
                    },
                    {
                        id: 'malvarrosa',
                        name: '馬爾瓦羅薩海灘',
                        image: 'https://images.unsplash.com/photo-1566496839352-7360249265ca?q=80&w=1000&auto=format&fit=crop',
                        description: '華倫西亞最受歡迎的城市海灘，寬闊的沙灘和長長的海濱長廊，布滿了餐廳。',
                        address: 'Passeig de Marítim, València',
                        transport: '電車 4, 6 號線。',
                        price: '免費',
                        hours: '24小時開放',
                        mapQuery: 'Playa de la Malvarrosa'
                    },
                    {
                        id: 'ceramics-museum',
                        name: '國立陶瓷博物館',
                        image: 'https://images.unsplash.com/photo-1629194246835-269e8b6b1076?q=80&w=1000&auto=format&fit=crop',
                        description: '前身為侯爵宮殿，其巴洛克風格的大門極盡奢華。館內收藏了精美的瓦倫西亞陶瓷。',
                        address: 'C/ del Poeta Querol, 2, 46002 València',
                        transport: '公車 4, 6, 31。',
                        price: '€3',
                        hours: '10:00 - 20:00 (週一休)',
                        mapQuery: 'Museo Nacional de Cerámica y Artes Suntuarias'
                    }
                ]
            },
            {
                id: 'travel-info',
                name: '旅遊資訊 & 文化',
                icon: 'fa-info-circle',
                cityMapQuery: 'Spain',
                attractions: [
                    {
                        id: 'culture-history',
                        name: '歷史與文化速覽',
                        image: 'https://images.unsplash.com/photo-1546591351-55e4981388ae?q=80&w=1000&auto=format&fit=crop',
                        description: '西班牙擁有豐富的歷史，曾受羅馬人與摩爾人（穆斯林）統治，造就了獨特的建築風格。文化上，西班牙人熱情奔放，佛朗明哥 (Flamenco) 是其靈魂。請注意當地特殊的作息時間：午餐通常在 14:00 後，晚餐則在 21:00 甚至更晚開始。',
                        address: 'Spain',
                        transport: 'N/A',
                        price: 'N/A',
                        hours: '午睡時間 (Siesta): 14:00-17:00 (部分商店休息)',
                        mapQuery: 'Spain'
                    },
                    {
                        id: 'travel-tips',
                        name: '旅遊實用筆記 (小費/電壓/作息)',
                        image: 'https://images.unsplash.com/photo-1515443961218-a51367888e4b?q=80&w=1000&auto=format&fit=crop',
                        description: `
                            <ul class="space-y-4">
                                <li class="flex items-start">
                                    <div class="flex-shrink-0 w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center mt-1 mr-3">
                                        <i class="fas fa-tint text-blue-500 text-sm"></i>
                                    </div>
                                    <div>
                                        <span class="font-bold text-slate-800 block">飲水建議</span>
                                        <span class="text-sm">大部分城市自來水可生飲，但南部(如Seville)口感略鹹，建議超市購買瓶裝水 (Agua mineral)。</span>
                                    </div>
                                </li>
                                <li class="flex items-start">
                                    <div class="flex-shrink-0 w-8 h-8 rounded-full bg-yellow-100 flex items-center justify-center mt-1 mr-3">
                                        <i class="fas fa-plug text-yellow-600 text-sm"></i>
                                    </div>
                                    <div>
                                        <span class="font-bold text-slate-800 block">電壓與插座</span>
                                        <span class="text-sm">230V，插座為歐規雙圓孔 (Type F)。台灣電器請務必攜帶轉接頭與變壓器。</span>
                                    </div>
                                </li>
                                <li class="flex items-start">
                                    <div class="flex-shrink-0 w-8 h-8 rounded-full bg-green-100 flex items-center justify-center mt-1 mr-3">
                                        <i class="fas fa-coins text-green-600 text-sm"></i>
                                    </div>
                                    <div>
                                        <span class="font-bold text-slate-800 block">小費文化</span>
                                        <span class="text-sm">非強制性。若服務良好，餐廳消費通常會留下零錢或 5-10% 作為心意。</span>
                                    </div>
                                </li>
                                <li class="flex items-start">
                                    <div class="flex-shrink-0 w-8 h-8 rounded-full bg-orange-100 flex items-center justify-center mt-1 mr-3">
                                        <i class="fas fa-sun text-orange-600 text-sm"></i>
                                    </div>
                                    <div>
                                        <span class="font-bold text-slate-800 block">夏季天氣</span>
                                        <span class="text-sm">極度炎熱乾燥（常超過40度），務必攜帶防曬乳、帽子、墨鏡及保濕用品。</span>
                                    </div>
                                </li>
                                <li class="flex items-start">
                                    <div class="flex-shrink-0 w-8 h-8 rounded-full bg-red-100 flex items-center justify-center mt-1 mr-3">
                                        <i class="fas fa-utensils text-red-500 text-sm"></i>
                                    </div>
                                    <div>
                                        <span class="font-bold text-slate-800 block">用餐時間 (重要)</span>
                                        <span class="text-sm">午餐約 14:00-16:00，晚餐約 21:00 後才開始。太早去餐廳可能還在準備中。</span>
                                    </div>
                                </li>
                                <li class="flex items-start">
                                    <div class="flex-shrink-0 w-8 h-8 rounded-full bg-purple-100 flex items-center justify-center mt-1 mr-3">
                                        <i class="fas fa-store text-purple-500 text-sm"></i>
                                    </div>
                                    <div>
                                        <span class="font-bold text-slate-800 block">商店營業</span>
                                        <span class="text-sm">一般 10:00-21:00，中小店鋪 14:00-17:00 可能午休；週日大部分商店（除紀念品店）不營業。</span>
                                    </div>
                                </li>
                                <li class="flex items-start">
                                    <div class="flex-shrink-0 w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center mt-1 mr-3">
                                        <i class="fas fa-receipt text-gray-600 text-sm"></i>
                                    </div>
                                    <div>
                                        <span class="font-bold text-slate-800 block">退稅 (Tax Free)</span>
                                        <span class="text-sm">非歐盟旅客在同一商店消費滿額可申請退稅，購物時請記得攜帶護照正本。</span>
                                    </div>
                                </li>
                            </ul>
                        `,
                        address: 'Spain',
                        transport: 'N/A',
                        price: 'N/A',
                        hours: 'N/A',
                        mapQuery: 'Spain'
                    },
                    {
                        id: 'safety',
                        name: '⚠️ 治安與安全指南',
                        image: 'https://images.unsplash.com/photo-1555881400-74d7acaacd81?q=80&w=1000&auto=format&fit=crop',
                        description: '【高度警示】巴塞隆納與馬德里的觀光區扒手猖獗。請注意：1. 背包請背前面。2. 餐廳用餐時，手機不要放桌上，包包不要掛椅背。3. 警惕「好心人」幫忙清理衣服髒汙（鳥屎騙局）或送迷迭香的吉普賽婦女。4. 地鐵上下車時最易被竊。',
                        address: 'Major tourist areas',
                        transport: '緊急電話: 112',
                        price: 'N/A',
                        hours: '隨時保持警覺',
                        mapQuery: 'Barcelona Police Station' 
                    }
                ]
            }
        ];

        // Global State
        let activeCity = null;
        let activeAttraction = null;
        let currentSlideIndex = 0;
        let carouselInterval = null;

        // DOM Elements
        const cityList = document.getElementById('city-list');
        const contentContainer = document.getElementById('content-container');
        const headerTitle = document.getElementById('header-title');
        const headerSubtitle = document.getElementById('header-subtitle');
        const mobileMenuBtn = document.getElementById('mobile-menu-btn');
        const sidebar = document.getElementById('sidebar');
        const closeSidebarBtn = document.getElementById('close-sidebar');

        // Functions
        function init() {
            // Hydrate Data with specific photos
            hydrateImages();
            
            renderSidebar();
            
            // Event Listeners
            mobileMenuBtn.addEventListener('click', toggleSidebar);
            closeSidebarBtn.addEventListener('click', toggleSidebar);
        }

        function hydrateImages() {
            // Mapping specific additional photos for attractions to simulate a gallery
            // Using stable Unsplash Image IDs
            const extraPhotoMap = {
                'alcazar': ['1626966603554-46961239c064', '1597652745348-18544c017d74'], // Sevilla Alcazar
                'plaza-espana': ['1563824557930-c3d386227b68', '1559563351-24b58e653ee4'], // Plaza Espana
                'catedral': ['1544923769-1c977254581e', '1677610667073-631d8c067527'], // Sevilla Cathedral
                'setas': ['1512699863456-e6347898858d', '1653928736348-3568c0757c67'], // Setas
                'prado': ['1579965563945-84227c81d113', '1576921366113-d30e326b0143'], // Prado (Arts)
                'royal-palace': ['1558641984-7264858b9758', '1572629737521-396434440026'], // Royal Palace
                'sagrada': ['1559313426-302773223023', '1564756543668-52e185856424'], // Sagrada Interior/Detail
                'park-guell': ['1558005391-727b38d356c9', '1566373303649-6f92023d8c1e'], // Park Guell
                'arts-science': ['1557954932-d85c49040375', '1520641042674-c6b7582b8813'], // Valencia Arts
                'eclipse-2026': ['1534358603612-42111eb443e0', '1610969641470-4f53587b649d', '1444703686981-a3abbc4d4fe3'], // Eclipse & Night
            };

            const genericSpainPhotos = [
                '1543783207-c0831a2b3853', // Architecture
                '1515443961218-a51367888e4b', // Food
                '1533618991475-4c07026771bc', // Street
                '1504198458649-3128b932f49e'  // People
            ];

            tripData.forEach(city => {
                city.attractions.forEach((attr, index) => {
                    // Start with the main image defined in data
                    attr.images = [attr.image];
                    
                    // Add specific extra photos if available, otherwise use generic valid ones
                    if (extraPhotoMap[attr.id]) {
                        extraPhotoMap[attr.id].forEach(id => {
                            attr.images.push(`https://images.unsplash.com/photo-${id}?auto=format&fit=crop&w=800&q=80`);
                        });
                    } else {
                        // Use generic photos based on index to avoid same photos everywhere
                        const genericId = genericSpainPhotos[index % genericSpainPhotos.length];
                        attr.images.push(`https://images.unsplash.com/photo-${genericId}?auto=format&fit=crop&w=800&q=80`);
                    }
                });
            });
        }

        function toggleSidebar() {
            sidebar.classList.toggle('-translate-x-full');
        }

        function renderSidebar() {
            cityList.innerHTML = '';
            
            tripData.forEach(city => {
                const li = document.createElement('li');
                li.className = 'group';
                
                // City Header
                const cityBtn = document.createElement('button');
                cityBtn.className = 'w-full text-left px-6 py-3 flex items-center justify-between hover:bg-slate-800 transition-colors focus:outline-none border-l-4 border-transparent';
                cityBtn.innerHTML = `
                    <span class="font-medium"><i class="fas ${city.icon} w-6 text-center mr-2 opacity-70"></i>${city.name}</span>
                    <i class="fas fa-chevron-down text-xs transition-transform transform ${activeCity === city.id ? 'rotate-180' : ''}"></i>
                `;
                
                // Toggle City
                cityBtn.onclick = () => {
                    if (activeCity === city.id) {
                        activeCity = null; // Close if already open
                        renderWelcome(); // Back to welcome screen
                    } else {
                        activeCity = city.id;
                        renderCityOverview(city); // Show City Map & Attractions
                    }
                    renderSidebar();
                };

                if (activeCity === city.id) {
                    cityBtn.classList.add('bg-slate-800', 'border-spain-red');
                    cityBtn.querySelector('span').classList.add('text-spain-yellow');
                }

                li.appendChild(cityBtn);

                // Attractions List (Sub-menu)
                if (activeCity === city.id) {
                    const ul = document.createElement('ul');
                    ul.className = 'bg-slate-950 py-2';
                    
                    city.attractions.forEach(attr => {
                        const attrLi = document.createElement('li');
                        const attrBtn = document.createElement('button');
                        const isEclipse = attr.id === 'eclipse-2026';
                        
                        attrBtn.className = `w-full text-left pl-14 pr-4 py-2 text-sm hover:text-white transition-colors flex items-center ${activeAttraction === attr.id ? 'text-spain-yellow font-bold' : 'text-slate-400'}`;
                        
                        let iconHtml = '';
                        if (isEclipse) {
                            iconHtml = '<i class="fas fa-star text-yellow-400 mr-2 animate-pulse"></i>';
                        }
                        // Special icon for warning
                        if (attr.id === 'safety') {
                            iconHtml = '<i class="fas fa-exclamation-triangle text-red-500 mr-2"></i>';
                        }

                        attrBtn.innerHTML = `${iconHtml}${attr.name}`;
                        
                        attrBtn.onclick = () => {
                            activeAttraction = attr.id;
                            renderSidebar(); // Re-render to update active styling
                            renderContent(city, attr);
                            // On mobile, close sidebar after selection
                            if (window.innerWidth < 768) {
                                toggleSidebar();
                            }
                        };
                        
                        attrLi.appendChild(attrBtn);
                        ul.appendChild(attrLi);
                    });
                    li.appendChild(ul);
                }

                cityList.appendChild(li);
            });
        }

        function renderWelcome() {
            activeAttraction = null;
            headerTitle.textContent = "歡迎開始旅程";
            headerSubtitle.textContent = "請從左側選擇城市與景點";
            document.getElementById('main-content-area').className = "flex-1 h-full overflow-y-auto relative w-full bg-gray-50";

            contentContainer.innerHTML = `
                <div class="flex flex-col items-center justify-center h-[60vh] text-center text-slate-400 fade-in">
                    <i class="fas fa-map-location-dot text-6xl mb-4 text-slate-300"></i>
                    <h3 class="text-xl font-medium">選擇左側選單開始規劃您的西班牙之旅</h3>
                    <p class="mt-2 text-sm">包含 Sevilla, Madrid, Barcelona 及 Valencia 日全食攻略</p>
                </div>
            `;
        }

        function renderCityOverview(city) {
            activeAttraction = null; // Clear active attraction
            headerTitle.textContent = city.name;
            headerSubtitle.textContent = "城市概覽與地圖";
            document.getElementById('main-content-area').className = "flex-1 h-full overflow-y-auto relative w-full bg-gray-50";

            // Generate HTML for attraction cards
            const attractionsCards = city.attractions.map(attr => {
                const isEclipse = attr.id === 'eclipse-2026';
                const isSafety = attr.id === 'safety';
                let cardBorder = 'border-slate-100 border';
                
                if (isEclipse) cardBorder = 'border-yellow-400 border-2';
                if (isSafety) cardBorder = 'border-red-400 border-2';
                
                let badge = '';
                if(isEclipse) badge = '<div class="absolute top-2 right-2 bg-yellow-400 text-slate-900 text-xs font-bold px-2 py-1 rounded shadow"><i class="fas fa-star mr-1"></i>特別活動</div>';
                if(isSafety) badge = '<div class="absolute top-2 right-2 bg-red-600 text-white text-xs font-bold px-2 py-1 rounded shadow"><i class="fas fa-exclamation-circle mr-1"></i>重要必讀</div>';

                return `
                <div class="bg-white rounded-xl shadow-sm ${cardBorder} overflow-hidden attraction-card cursor-pointer transition-all duration-300 group" 
                     onclick="activeAttraction = '${attr.id}'; renderSidebar(); renderContent(tripData.find(c => c.id === '${city.id}'), tripData.find(c => c.id === '${city.id}').attractions.find(a => a.id === '${attr.id}'))">
                    <div class="h-40 w-full overflow-hidden relative">
                        <img src="${attr.image}" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110" alt="${attr.name}">
                        ${badge}
                    </div>
                    <div class="p-4">
                        <h4 class="font-bold text-lg text-slate-800 mb-1 group-hover:text-spain-red transition-colors">${attr.name}</h4>
                        <p class="text-sm text-slate-500 line-clamp-2">${attr.description.replace(/<[^>]*>?/gm, '')}</p>
                        <div class="mt-3 flex items-center text-xs text-spain-red font-medium">
                            查看詳情 <i class="fas fa-arrow-right ml-1 transition-transform group-hover:translate-x-1"></i>
                        </div>
                    </div>
                </div>
                `;
            }).join('');

            contentContainer.innerHTML = `
                <div class="fade-in space-y-8">
                    <!-- Map Section -->
                    <div class="bg-white p-2 rounded-xl shadow-sm border border-slate-200">
                        <div class="w-full h-[400px] bg-slate-100 rounded-lg overflow-hidden relative">
                            <iframe 
                                width="100%" 
                                height="100%" 
                                frameborder="0" 
                                style="border:0; position: absolute; top:0; left:0;" 
                                src="https://www.google.com/maps?q=${encodeURIComponent(city.cityMapQuery)}&output=embed"
                                allowfullscreen>
                            </iframe>
                            <div class="absolute bottom-4 left-4 bg-white/90 backdrop-blur-sm px-3 py-1.5 rounded shadow text-xs font-medium text-slate-600">
                                <i class="fas fa-map-marker-alt text-red-500 mr-1"></i> ${city.name} 旅遊地圖
                            </div>
                        </div>
                    </div>

                    <!-- Attractions List -->
                    <div>
                        <h3 class="text-xl font-bold text-slate-800 mb-4 flex items-center">
                            <i class="fas fa-list-ul text-spain-red mr-2"></i> ${city.name} 精選內容
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            ${attractionsCards}
                        </div>
                    </div>
                </div>
            `;
        }

        // --- Carousel Logic ---
        function renderCarousel(images) {
            if (!images || images.length === 0) return '';
            
            const slidesHtml = images.map((img, index) => `
                <div class="carousel-slide flex-shrink-0 relative" style="background-image: url('${img}')">
                    <div class="absolute inset-0 carousel-overlay"></div>
                </div>
            `).join('');

            const indicatorsHtml = images.map((_, index) => `
                <button onclick="goToSlide(${index})" class="w-2 h-2 rounded-full transition-all duration-300 ${index === 0 ? 'bg-white w-4' : 'bg-white/50 hover:bg-white/80'}" id="indicator-${index}"></button>
            `).join('');

            return `
                <div class="relative w-full h-64 md:h-96 rounded-xl overflow-hidden shadow-lg group bg-slate-900">
                    <div id="carousel-track" class="carousel-track">
                        ${slidesHtml}
                    </div>

                    <!-- Controls -->
                    <button onclick="moveSlide(-1)" class="absolute top-1/2 left-4 -translate-y-1/2 w-10 h-10 flex items-center justify-center bg-black/30 backdrop-blur-sm text-white rounded-full hover:bg-black/50 transition opacity-0 group-hover:opacity-100 focus:opacity-100 z-10">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <button onclick="moveSlide(1)" class="absolute top-1/2 right-4 -translate-y-1/2 w-10 h-10 flex items-center justify-center bg-black/30 backdrop-blur-sm text-white rounded-full hover:bg-black/50 transition opacity-0 group-hover:opacity-100 focus:opacity-100 z-10">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                    
                    <!-- Indicators -->
                    <div class="absolute bottom-4 left-1/2 -translate-x-1/2 flex space-x-2 z-10">
                        ${indicatorsHtml}
                    </div>

                    <!-- Auto-play progress bar (optional visual) -->
                    <div class="absolute bottom-0 left-0 h-1 bg-spain-yellow transition-all duration-[5000ms] ease-linear w-0" id="progress-bar"></div>
                </div>
            `;
        }

        function moveSlide(direction) {
            if (!activeAttraction) return;
            
            // Find current attraction data
            let currentAttrData = null;
            // Need to find the attraction in the data structure
            for(const city of tripData) {
                const found = city.attractions.find(a => a.id === activeAttraction);
                if(found) {
                    currentAttrData = found;
                    break;
                }
            }
            
            if(!currentAttrData) return;

            const totalSlides = currentAttrData.images.length;
            currentSlideIndex = (currentSlideIndex + direction + totalSlides) % totalSlides;
            updateCarouselUI();
            resetAutoPlay();
        }

        function goToSlide(index) {
            currentSlideIndex = index;
            updateCarouselUI();
            resetAutoPlay();
        }

        function updateCarouselUI() {
            const track = document.getElementById('carousel-track');
            if(track) {
                track.style.transform = `translateX(-${currentSlideIndex * 100}%)`;
            }

            // Update indicators
            const indicators = document.querySelectorAll('[id^="indicator-"]');
            indicators.forEach((ind, idx) => {
                if(idx === currentSlideIndex) {
                    ind.classList.remove('bg-white/50', 'w-2');
                    ind.classList.add('bg-white', 'w-4');
                } else {
                    ind.classList.remove('bg-white', 'w-4');
                    ind.classList.add('bg-white/50', 'w-2');
                }
            });
        }

        function startAutoPlay() {
            if(carouselInterval) clearInterval(carouselInterval);
            carouselInterval = setInterval(() => {
                moveSlide(1);
            }, 5000); 
        }

        function resetAutoPlay() {
            clearInterval(carouselInterval);
            startAutoPlay();
        }

        // --- Content Rendering ---

        function renderContent(city, attr) {
            // Update Header
            headerTitle.textContent = attr.name;
            headerSubtitle.textContent = `${city.name} > ${attr.name}`;

            // Reset Slide Index
            currentSlideIndex = 0;
            if(carouselInterval) clearInterval(carouselInterval);

            // Check if it is the special Eclipse event
            if (attr.type === 'special') {
                renderEclipseContent(attr);
            } else {
                renderRegularAttraction(attr);
            }

            // Start Autoplay after render
            setTimeout(startAutoPlay, 100);
        }

        function renderRegularAttraction(attr) {
            // Reset background for normal attractions
            document.getElementById('main-content-area').className = "flex-1 h-full overflow-y-auto relative w-full bg-gray-50";

            // Generate Carousel HTML
            const carouselHtml = renderCarousel(attr.images);

            // Check if specific hours/price are applicable
            const showHours = attr.hours !== 'N/A';
            const showPrice = attr.price !== 'N/A';
            const showTransport = attr.transport !== 'N/A';
            
            // Generate Google Maps Link for User Photos
            const googleMapsUrl = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(attr.mapQuery)}`;

            contentContainer.innerHTML = `
                <div class="fade-in space-y-6">
                    <!-- Carousel Hero -->
                    <div class="relative">
                        ${carouselHtml}
                        <!-- Google Maps User Photos Button -->
                        <div class="absolute bottom-4 right-4 z-20">
                            <a href="${googleMapsUrl}" target="_blank" class="flex items-center gap-2 bg-white/90 hover:bg-white text-slate-800 text-xs font-bold py-2 px-4 rounded-full shadow-lg transition transform hover:scale-105 backdrop-blur-sm border border-slate-200">
                                <img src="https://upload.wikimedia.org/wikipedia/commons/a/aa/Google_Maps_icon_%282020%29.svg" class="w-4 h-4" alt="GMap">
                                <span>在 Google Maps 查看網友實拍</span>
                                <i class="fas fa-external-link-alt text-slate-400"></i>
                            </a>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <!-- Left Column: Details -->
                        <div class="lg:col-span-2 space-y-6">
                            <!-- Description -->
                            <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                                <h3 class="text-lg font-bold text-slate-800 mb-3 border-b pb-2"><i class="fas fa-info-circle mr-2 text-spain-red"></i>介紹</h3>
                                <div class="text-slate-600 leading-relaxed">${attr.description}</div>
                            </div>

                            <!-- Info Grid -->
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                ${showHours ? `
                                <div class="bg-white p-5 rounded-xl shadow-sm border border-slate-100">
                                    <h4 class="font-bold text-slate-700 mb-2"><i class="fas fa-clock mr-2 text-blue-500"></i>時間/注意</h4>
                                    <p class="text-sm text-slate-600">${attr.hours}</p>
                                </div>` : ''}
                                ${showPrice ? `
                                <div class="bg-white p-5 rounded-xl shadow-sm border border-slate-100">
                                    <h4 class="font-bold text-slate-700 mb-2"><i class="fas fa-ticket-alt mr-2 text-green-500"></i>費用/備註</h4>
                                    <p class="text-sm text-slate-600">${attr.price}</p>
                                </div>` : ''}
                                ${showTransport ? `
                                <div class="bg-white p-5 rounded-xl shadow-sm border border-slate-100 md:col-span-2">
                                    <h4 class="font-bold text-slate-700 mb-2"><i class="fas fa-bus mr-2 text-orange-500"></i>交通/緊急聯絡</h4>
                                    <p class="text-sm text-slate-600">${attr.transport}</p>
                                </div>` : ''}
                            </div>
                        </div>

                        <!-- Right Column: Map -->
                        <div class="lg:col-span-1">
                            <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-100 h-full flex flex-col">
                                <h3 class="text-lg font-bold text-slate-800 mb-3"><i class="fas fa-map-marked-alt mr-2 text-spain-red"></i>相關位置</h3>
                                <div class="flex-1 w-full bg-slate-100 rounded-lg overflow-hidden min-h-[300px] relative">
                                    <iframe 
                                        width="100%" 
                                        height="100%" 
                                        frameborder="0" 
                                        style="border:0; position: absolute; top:0; left:0;" 
                                        src="https://www.google.com/maps?q=${encodeURIComponent(attr.mapQuery)}&output=embed"
                                        allowfullscreen>
                                    </iframe>
                                </div>
                                <div class="mt-4">
                                    <a href="${googleMapsUrl}" target="_blank" class="block w-full text-center bg-slate-50 hover:bg-slate-100 border border-slate-200 text-slate-600 text-sm font-medium py-2 px-4 rounded-lg transition flex items-center justify-center gap-2">
                                        <i class="fas fa-images text-blue-500"></i> 更多用戶上傳照片
                                    </a>
                                </div>
                                <p class="mt-3 text-xs text-slate-500"><i class="fas fa-map-pin mr-1"></i> ${attr.address}</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderEclipseContent(attr) {
            // Dark Mode Background for Eclipse Page
            document.getElementById('main-content-area').className = "flex-1 h-full overflow-y-auto relative w-full eclipse-gradient text-white";

            // Reuse Carousel for Eclipse too
            const carouselHtml = renderCarousel(attr.images);
            
            // Generate Google Maps Link
            const googleMapsUrl = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(attr.mapQuery)}`;

            contentContainer.innerHTML = `
                <div class="fade-in max-w-5xl mx-auto pb-10">
                    
                    <!-- Header Banner -->
                    <div class="text-center py-10 relative">
                        <div class="inline-block relative">
                             <div class="w-32 h-32 rounded-full bg-black shadow-[0_0_50px_10px_rgba(253,224,71,0.6)] border border-yellow-500/30 mx-auto relative z-10 flex items-center justify-center">
                                <div class="w-31 h-31 rounded-full bg-gray-900 absolute -right-1 -top-1"></div>
                             </div>
                        </div>
                        <h2 class="text-4xl md:text-5xl font-bold mt-6 text-transparent bg-clip-text bg-gradient-to-r from-yellow-200 to-amber-500">2026 大西班牙日全食</h2>
                        <p class="text-indigo-200 mt-2 text-lg">華倫西亞站 • 重點行程</p>
                    </div>

                    <!-- Images Section -->
                    <div class="mb-8 rounded-xl overflow-hidden border border-indigo-500/30 relative">
                         ${carouselHtml}
                         
                         <!-- Google Maps User Photos Button (Dark Mode) -->
                        <div class="absolute bottom-4 right-4 z-20">
                            <a href="${googleMapsUrl}" target="_blank" class="flex items-center gap-2 bg-slate-800/90 hover:bg-slate-700 text-white text-xs font-bold py-2 px-4 rounded-full shadow-lg transition transform hover:scale-105 backdrop-blur-sm border border-indigo-500/50">
                                <img src="https://upload.wikimedia.org/wikipedia/commons/a/aa/Google_Maps_icon_%282020%29.svg" class="w-4 h-4" alt="GMap">
                                <span>查看觀測點實景</span>
                            </a>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderEclipseContent(attr) {
            // Dark Mode Background for Eclipse Page
            document.getElementById('main-content-area').className = "flex-1 h-full overflow-y-auto relative w-full eclipse-gradient text-white";

            // Reuse Carousel for Eclipse too
            const carouselHtml = renderCarousel(attr.images);
            
            // Generate Google Maps Link
            const googleMapsUrl = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(attr.mapQuery)}`;

            contentContainer.innerHTML = `
                <div class="fade-in max-w-5xl mx-auto pb-10">
                    
                    <!-- Header Banner -->
                    <div class="text-center py-10 relative">
                        <div class="inline-block relative">
                             <div class="w-32 h-32 rounded-full bg-black shadow-[0_0_50px_10px_rgba(253,224,71,0.6)] border border-yellow-500/30 mx-auto relative z-10 flex items-center justify-center">
                                <div class="w-31 h-31 rounded-full bg-gray-900 absolute -right-1 -top-1"></div>
                             </div>
                        </div>
                        <h2 class="text-4xl md:text-5xl font-bold mt-6 text-transparent bg-clip-text bg-gradient-to-r from-yellow-200 to-amber-500">2026 大西班牙日全食</h2>
                        <p class="text-indigo-200 mt-2 text-lg">華倫西亞站 • 重點行程</p>
                    </div>

                    <!-- Images Section -->
                    <div class="mb-8 rounded-xl overflow-hidden border border-indigo-500/30">
                         ${carouselHtml}
                         <p class="text-center text-xs text-indigo-300 mt-2">滑動查看日食模擬圖及觀測地景色</p>
                    </div>

                    <!-- Key Info Cards -->
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
                        <div class="bg-white/10 backdrop-blur-md p-6 rounded-2xl border border-white/10 hover:bg-white/20 transition">
                            <i class="fas fa-calendar-alt text-3xl text-yellow-400 mb-3"></i>
                            <h3 class="text-sm uppercase tracking-wider text-indigo-300 font-bold">日期</h3>
                            <p class="text-lg font-medium">${attr.date}</p>
                        </div>
                        <div class="bg-white/10 backdrop-blur-md p-6 rounded-2xl border border-white/10 hover:bg-white/20 transition">
                            <i class="fas fa-clock text-3xl text-yellow-400 mb-3"></i>
                            <h3 class="text-sm uppercase tracking-wider text-indigo-300 font-bold">全食時間</h3>
                            <p class="text-lg font-medium">約 20:30 (傍晚)</p>
                        </div>
                        <div class="bg-white/10 backdrop-blur-md p-6 rounded-2xl border border-white/10 hover:bg-white/20 transition">
                            <i class="fas fa-compass text-3xl text-yellow-400 mb-3"></i>
                            <h3 class="text-sm uppercase tracking-wider text-indigo-300 font-bold">觀測方位</h3>
                            <p class="text-lg font-medium">${attr.direction}</p>
                        </div>
                         <div class="bg-white/10 backdrop-blur-md p-6 rounded-2xl border border-white/10 hover:bg-white/20 transition">
                            <i class="fas fa-mountain text-3xl text-yellow-400 mb-3"></i>
                            <h3 class="text-sm uppercase tracking-wider text-indigo-300 font-bold">最佳位置</h3>
                            <p class="text-sm font-medium">Sagunto 城堡 (制高點)</p>
                        </div>
                    </div>
                    
                    <div class="text-center mb-8">
                        <a href="${googleMapsUrl}" target="_blank" class="inline-block bg-white/10 hover:bg-white/20 border border-white/30 text-white font-medium py-2 px-6 rounded-full shadow-sm transition">
                            <i class="fas fa-map-marked-alt mr-2 text-yellow-400"></i> 在 Google Maps 查看觀測點實景
                        </a>
                    </div>

                    <!-- Main Guide Content -->
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                        
                        <!-- Timeline & Details -->
                        <div class="lg:col-span-2 space-y-6">
                            <div class="bg-slate-900/50 p-8 rounded-2xl border border-indigo-500/30">
                                <h3 class="text-2xl font-bold mb-4 text-yellow-400"><i class="fas fa-meteor mr-3"></i>觀測指南</h3>
                                <p class="text-indigo-100 leading-relaxed mb-4">
                                    這是一次極為罕見的「日落日食」。在華倫西亞地區，日全食發生時太陽高度非常低（約在海平面上 6-10 度）。
                                </p>
                                <div class="bg-indigo-900/40 p-4 rounded-lg border-l-4 border-yellow-500 mb-6">
                                    <h4 class="font-bold text-white mb-1">為什麼選擇薩貢托城堡 (Castillo de Sagunto)？</h4>
                                    <p class="text-sm text-indigo-200">
                                        為了觀測低角度的日食，必須避開西方地平線的建築物或山脈遮擋。薩貢托城堡位於山頂，擁有開闊的西方全景視野，是確保能完整看到「黑太陽」沒入地平線的最佳高地。
                                    </p>
                                </div>
                                
                                <h4 class="text-xl font-bold mb-3 text-white">時間表 (當地時間)</h4>
                                <ul class="space-y-3 relative border-l border-indigo-500/30 ml-3 pl-6">
                                    <li class="relative">
                                        <span class="absolute -left-[29px] bg-indigo-500 w-4 h-4 rounded-full border-2 border-slate-900"></span>
                                        <span class="text-yellow-400 font-bold mr-2">19:38</span> <span class="text-white">初虧 (偏食開始)</span>
                                    </li>
                                    <li class="relative">
                                        <span class="absolute -left-[29px] bg-yellow-500 w-4 h-4 rounded-full border-2 border-slate-900 shadow-[0_0_10px_rgba(234,179,8,0.8)]"></span>
                                        <span class="text-yellow-400 font-bold mr-2">20:29 - 20:31</span> <span class="text-white text-lg font-bold">食甚 (日全食 - 震撼時刻)</span>
                                    </li>
                                    <li class="relative">
                                        <span class="absolute -left-[29px] bg-indigo-500 w-4 h-4 rounded-full border-2 border-slate-900"></span>
                                        <span class="text-yellow-400 font-bold mr-2">20:33</span> <span class="text-white">生光 (全食結束)</span>
                                    </li>
                                    <li class="relative">
                                        <span class="absolute -left-[29px] bg-indigo-900 w-4 h-4 rounded-full border-2 border-slate-900"></span>
                                        <span class="text-yellow-400 font-bold mr-2">21:10</span> <span class="text-white">日落</span>
                                    </li>
                                </ul>
                            </div>
                        </div>

                        <!-- Safety & Tips -->
                        <div class="lg:col-span-1 space-y-6">
                            <div class="bg-red-900/30 p-6 rounded-2xl border border-red-500/30">
                                <h3 class="text-xl font-bold mb-4 text-red-400"><i class="fas fa-exclamation-triangle mr-2"></i>安全警告</h3>
                                <ul class="space-y-3 text-sm text-red-100">
                                    <li class="flex items-start"><i class="fas fa-check mt-1 mr-2 text-red-400"></i>在全食階段之外，必須全程佩戴 ISO 12312-2 認證的日食眼鏡。</li>
                                    <li class="flex items-start"><i class="fas fa-check mt-1 mr-2 text-red-400"></i>普通的太陽眼鏡、相機底片或煙燻玻璃都不安全。</li>
                                    <li class="flex items-start"><i class="fas fa-check mt-1 mr-2 text-red-400"></i>如果要用相機拍攝，鏡頭前必須加裝巴德膜 (Solar Filter)，否則感光元件會燒毀。</li>
                                </ul>
                            </div>

                            <div class="bg-blue-900/30 p-6 rounded-2xl border border-blue-500/30">
                                <h3 class="text-xl font-bold mb-4 text-blue-300"><i class="fas fa-lightbulb mr-2"></i>行家貼士</h3>
                                <ul class="space-y-3 text-sm text-blue-100">
                                    <li class="flex items-start"><i class="fas fa-angle-right mt-1 mr-2 text-blue-400"></i><b>佔位要早：</b>城堡是熱門觀測點，建議下午提早到達。</li>
                                    <li class="flex items-start"><i class="fas fa-angle-right mt-1 mr-2 text-blue-400"></i><b>帶外套：</b>日全食發生時，氣溫可能在幾分鐘內下降 5-10 度，加上山頂風大。</li>
                                    <li class="flex items-start"><i class="fas fa-angle-right mt-1 mr-2 text-blue-400"></i><b>看西方：</b>在城堡上尋找一個面向西方的開闊位置坐下。</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Initialize App
        document.addEventListener('DOMContentLoaded', init);

    </script>
</body>
</html>