<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>水銀玻管體溫計模型</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* 定義甩動動畫 */
        @keyframes shake {
            0% { transform: translate(1px, 1px) rotate(0deg); }
            10% { transform: translate(-1px, -2px) rotate(-1deg); }
            20% { transform: translate(-3px, 0px) rotate(1deg); }
            30% { transform: translate(3px, 2px) rotate(0deg); }
            40% { transform: translate(1px, -1px) rotate(1deg); }
            50% { transform: translate(-1px, 2px) rotate(-1deg); }
            60% { transform: translate(-3px, 1px) rotate(0deg); }
            70% { transform: translate(3px, 1px) rotate(-1deg); }
            80% { transform: translate(-1px, -1px) rotate(1deg); }
            90% { transform: translate(1px, 2px) rotate(0deg); }
            100% { transform: translate(1px, -2px) rotate(-1deg); }
        }
        .animate-shake {
            animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
        }
        
        /* 確保範圍輸入滑桿樣式一致 */
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 20px;
            width: 20px;
            border-radius: 50%;
            background: #2563eb;
            cursor: pointer;
            margin-top: -8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%;
            height: 4px;
            cursor: pointer;
            background: #cbd5e1;
            border-radius: 2px;
        }
    </style>
</head>
<body class="min-h-screen bg-slate-50 font-sans text-slate-800 p-4 md:p-8 pb-48 relative overflow-y-auto flex flex-col">

    <!-- Header -->
    <header class="mb-6 text-center md:text-left z-10">
        <h1 class="text-3xl font-bold text-slate-800 flex items-center gap-2 justify-center md:justify-start">
            <!-- Thermometer Icon -->
            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-8 h-8 text-blue-700">
                <path d="M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z"/><path d="M15 2v2"/><path d="M15 10v2"/><path d="M9 2v2"/><path d="M9 10v2"/>
            </svg>
            水銀玻管體溫計模型
        </h1>
        <p class="text-slate-600 mt-2">物理實驗模擬：熱脹冷縮與截流區原理</p>
    </header>

    <!-- Main Display Area -->
    <main class="flex-grow flex flex-col items-center w-full max-w-5xl mx-auto relative z-10">
        
        <!-- 體溫計 SVG 容器 -->
        <div id="thermometer-container" class="w-full bg-white rounded-xl shadow-xl p-4 md:p-8 mb-6 border border-slate-200 transition-transform">
            <div class="relative w-full aspect-[3/1] md:aspect-[3.5/1]">
                <svg viewBox="0 0 800 220" class="w-full h-full">
                    <defs>
                        <!-- 玻璃質感漸層 (帶有淡淡的青藍色，模擬厚玻璃) -->
                        <linearGradient id="glassGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" stop-color="rgba(240,250,255,0.8)" />
                            <stop offset="20%" stop-color="rgba(220,240,250,0.3)" />
                            <stop offset="50%" stop-color="rgba(255,255,255,0.1)" /> <!-- 中間透光 -->
                            <stop offset="80%" stop-color="rgba(200,230,245,0.4)" />
                            <stop offset="100%" stop-color="rgba(180,210,230,0.6)" />
                        </linearGradient>
                        
                        <!-- 傳統體溫計的黃色琺瑯背襯 (Yellow Backing) -->
                        <linearGradient id="enamelBacking" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" stop-color="#fef9c3" /> <!-- yellow-100 -->
                            <stop offset="50%" stop-color="#fde047" /> <!-- yellow-300 -->
                            <stop offset="100%" stop-color="#fef9c3" />
                        </linearGradient>

                        <!-- 水銀質感漸層 (高對比金屬銀) -->
                        <linearGradient id="mercuryGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" stop-color="#64748b" />   <!-- Slate 500 (深灰邊緣) -->
                            <stop offset="30%" stop-color="#f8fafc" />   <!-- Slate 50 (強烈高光) -->
                            <stop offset="50%" stop-color="#cbd5e1" />   <!-- Slate 300 (金屬銀) -->
                            <stop offset="70%" stop-color="#f8fafc" />   <!-- Slate 50 (強烈高光) -->
                            <stop offset="100%" stop-color="#64748b" />  <!-- Slate 500 (深灰邊緣) -->
                        </linearGradient>
                    </defs>

                    <!-- 0. 琺瑯背襯 (位於毛細管後方，增加對比度) -->
                    <!-- 僅在管身部分顯示 -->
                    <path d="M 150,95 L 740,95 L 740,125 L 150,125 Z" fill="url(#enamelBacking)" opacity="0.6" />

                    <!-- 1. 玻璃管主體 (Body) -->
                    <g>
                        <!-- 管身輪廓 -->
                        <path d="M 80,90 L 750,90 Q 770,90 770,110 Q 770,130 750,130 L 80,130 Z" fill="url(#glassGradient)" stroke="#94a3b8" stroke-width="1.5" />
                        
                        <!-- 液泡 (更圓潤的形狀) -->
                        <ellipse cx="60" cy="110" rx="45" ry="35" fill="url(#glassGradient)" stroke="#94a3b8" stroke-width="1.5" />
                        
                        <!-- 連接處平滑化遮罩 -->
                        <path d="M 60,75 Q 95,75 100,90" fill="none" stroke="#94a3b8" stroke-width="0" /> 
                    </g>

                    <!-- 2. 內部水銀 - 液泡 (Bulb) -->
                    <ellipse cx="60" cy="110" rx="38" ry="28" fill="url(#mercuryGradient)" />

                    <!-- 3. 截流區 (Kink) -->
                    <!-- 玻璃通道輪廓 (深色細線) -->
                    <path d="M 105,110 L 115,102 L 125,110 L 135,102 L 145,110" fill="none" stroke="rgba(100, 116, 139, 0.4)" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>

                    <!-- 截流區水銀 (動態) -->
                    <path id="kink-mercury" d="M 92,110 L 105,110 L 115,102 L 125,110 L 135,102 L 145,110 L 150,110" fill="none" stroke="url(#mercuryGradient)" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" />

                    <!-- 4. 毛細管水銀 (Mercury Column) -->
                    <!-- 稍微加粗一點點，讓它在黃色背景上更清楚 -->
                    <rect id="mercury-column" x="150" y="106.5" width="0" height="7" fill="url(#mercuryGradient)" class="transition-all duration-300 ease-out" rx="3.5" />

                    <!-- 5. 玻璃高光 (Highlights) - 增加立體感 -->
                    <!-- 上方高光 -->
                    <path d="M 150,95 L 740,95" stroke="rgba(255,255,255,0.8)" stroke-width="3" stroke-linecap="round" fill="none" />
                    <!-- 下方反光 -->
                    <path d="M 150,125 L 740,125" stroke="rgba(255,255,255,0.4)" stroke-width="2" stroke-linecap="round" fill="none" />
                    <!-- 液泡高光 -->
                    <ellipse cx="45" cy="95" rx="10" ry="6" fill="rgba(255,255,255,0.7)" transform="rotate(-30 45 95)" />


                    <!-- 6. 刻度 (Scale) -->
                    <!-- 35°C -->
                    <g transform="translate(0,0)">
                        <line x1="150" y1="90" x2="150" y2="82" stroke="#1e293b" stroke-width="2" />
                        <text x="150" y="75" text-anchor="middle" class="text-xs fill-slate-800 font-bold" style="font-size: 16px">35°C</text>
                        <!-- 小刻度 -->
                        <line x1="191.4" y1="90" x2="191.4" y2="86" stroke="#64748b" stroke-width="1" />
                    </g>
                    <!-- 36°C -->
                    <g transform="translate(82.85,0)">
                        <line x1="150" y1="90" x2="150" y2="82" stroke="#1e293b" stroke-width="2" />
                        <text x="150" y="75" text-anchor="middle" class="text-xs fill-slate-800 font-bold" style="font-size: 16px">36°C</text>
                        <line x1="191.4" y1="90" x2="191.4" y2="86" stroke="#64748b" stroke-width="1" />
                    </g>
                     <!-- 37°C (紅色) -->
                     <g transform="translate(165.7,0)">
                        <line x1="150" y1="90" x2="150" y2="80" stroke="#dc2626" stroke-width="2.5" /> 
                        <text x="150" y="75" text-anchor="middle" class="text-xs fill-red-600 font-bold" style="font-size: 18px">37°C</text>
                        <line x1="191.4" y1="90" x2="191.4" y2="86" stroke="#64748b" stroke-width="1" />
                    </g>
                     <!-- 38°C -->
                     <g transform="translate(248.55,0)">
                        <line x1="150" y1="90" x2="150" y2="82" stroke="#1e293b" stroke-width="2" />
                        <text x="150" y="75" text-anchor="middle" class="text-xs fill-slate-800 font-bold" style="font-size: 16px">38°C</text>
                        <line x1="191.4" y1="90" x2="191.4" y2="86" stroke="#64748b" stroke-width="1" />
                    </g>
                     <!-- 39°C -->
                     <g transform="translate(331.4,0)">
                        <line x1="150" y1="90" x2="150" y2="82" stroke="#1e293b" stroke-width="2" />
                        <text x="150" y="75" text-anchor="middle" class="text-xs fill-slate-800 font-bold" style="font-size: 16px">39°C</text>
                        <line x1="191.4" y1="90" x2="191.4" y2="86" stroke="#64748b" stroke-width="1" />
                    </g>
                     <!-- 40°C -->
                     <g transform="translate(414.25,0)">
                        <line x1="150" y1="90" x2="150" y2="82" stroke="#1e293b" stroke-width="2" />
                        <text x="150" y="75" text-anchor="middle" class="text-xs fill-slate-800 font-bold" style="font-size: 16px">40°C</text>
                        <line x1="191.4" y1="90" x2="191.4" y2="86" stroke="#64748b" stroke-width="1" />
                    </g>
                     <!-- 41°C -->
                     <g transform="translate(497.1,0)">
                        <line x1="150" y1="90" x2="150" y2="82" stroke="#1e293b" stroke-width="2" />
                        <text x="150" y="75" text-anchor="middle" class="text-xs fill-slate-800 font-bold" style="font-size: 16px">41°C</text>
                        <line x1="191.4" y1="90" x2="191.4" y2="86" stroke="#64748b" stroke-width="1" />
                    </g>
                     <!-- 42°C -->
                     <g transform="translate(580,0)">
                        <line x1="150" y1="90" x2="150" y2="82" stroke="#1e293b" stroke-width="2" />
                        <text x="150" y="75" text-anchor="middle" class="text-xs fill-slate-800 font-bold" style="font-size: 16px">42°C</text>
                    </g>


                    <!-- 7. 標籤系統 -->
                    <line x1="125" y1="75" x2="125" y2="45" stroke="#ef4444" stroke-width="2" />
                    <text x="125" y="35" text-anchor="middle" class="fill-red-600 font-bold text-lg">截流區</text>
                    
                    <!-- 指示斷裂點 (僅在斷裂時顯示) -->
                    <g id="broken-indicator" class="animate-pulse" style="display: none;">
                        <circle cx="125" cy="106" r="15" fill="none" stroke="#ef4444" stroke-width="2" stroke-dasharray="4 2" />
                        <text x="125" y="145" text-anchor="middle" class="fill-red-500 text-sm font-bold">真空/斷裂</text>
                    </g>
                </svg>
            </div>
            
            <!-- 數字顯示與狀態欄 -->
            <div class="flex flex-wrap justify-between items-center mt-4 px-4 gap-4">
                <div class="flex gap-6">
                    <div class="bg-slate-100 px-4 py-2 rounded-lg border border-slate-300 shadow-sm">
                        <span class="text-slate-500 text-xs block font-semibold">環境溫度 (模擬)</span>
                        <span id="display-ambient" class="text-xl font-mono font-bold text-slate-700">36.5°C</span>
                    </div>
                    <div class="bg-blue-50 px-4 py-2 rounded-lg border border-blue-200 shadow-sm">
                        <span class="text-blue-600 text-xs block font-semibold">體溫計讀數</span>
                        <span id="display-mercury" class="text-2xl font-mono font-bold text-blue-600">36.5°C</span>
                    </div>
                </div>
                
                <div id="warning-box" class="flex-1 flex items-center gap-2 text-amber-800 bg-amber-50 px-4 py-2 rounded-lg border border-amber-200 animate-pulse shadow-sm" style="display: none;">
                    <!-- Info Icon -->
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="flex-shrink-0 text-amber-600"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg>
                    <span class="font-medium text-sm">截流區發生斷裂！讀數保持在最高溫。</span>
                </div>
            </div>
        </div>

        <!-- 控制面板 -->
        <div class="w-full bg-white p-6 rounded-xl shadow-lg border border-slate-100 flex flex-col md:flex-row gap-8 items-center justify-between">
            
            <div class="flex-1 w-full">
                <label class="flex justify-between mb-3 font-bold text-slate-700">
                    <span>調整環境溫度</span>
                </label>
                <div class="relative">
                    <input 
                        id="temp-slider"
                        type="range" 
                        min="35.0" 
                        max="42.0" 
                        step="0.1"
                        value="36.5"
                        class="w-full h-4 bg-slate-200 rounded-full appearance-none cursor-pointer accent-blue-600 hover:accent-blue-500"
                    />
                </div>
                <div class="flex justify-between text-xs text-slate-400 mt-2 font-medium">
                    <span>35°C (冷)</span>
                    <span>37°C (常溫)</span>
                    <span>42°C (熱)</span>
                </div>
            </div>

            <div class="flex flex-col items-center gap-2 w-full md:w-auto">
                <button 
                    id="shake-btn"
                    class="w-full md:w-auto flex items-center justify-center gap-3 px-8 py-4 rounded-xl font-bold text-lg shadow-md transition-all bg-slate-100 text-slate-400 border border-slate-200 cursor-default"
                >
                    <!-- RotateCcw Icon -->
                    <svg id="shake-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/></svg>
                    <span id="shake-text">甩動體溫計</span>
                </button>
                <span id="shake-hint" class="text-xs text-slate-500 h-4"></span>
            </div>

        </div>

    </main>

    <!-- 右下角原理說明 -->
    <div class="fixed bottom-4 right-4 md:bottom-8 md:right-8 w-[90%] md:w-80 bg-yellow-50 border-l-4 border-yellow-400 p-4 shadow-2xl rounded-r-lg z-50 text-sm md:text-base opacity-95 hover:opacity-100 transition-opacity">
        <h3 class="font-bold text-yellow-800 mb-2 flex items-center gap-2">
            <!-- Info Icon -->
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg>
            截流區原理 (Kink)
        </h3>
        <div class="space-y-2 text-yellow-900">
            <p>
                <span class="font-bold text-yellow-700">1. 結構特徵：</span>
                液泡上方有一段極細且彎曲的管道，稱為「截流區」。
            </p>
            <p>
                <span class="font-bold text-yellow-700">2. 降溫斷裂：</span>
                當溫度下降，水銀收縮力不足以通過狹窄彎道，水銀柱會在此處<span class="font-bold text-red-600">斷開</span>。
            </p>
            <p>
                <span class="font-bold text-yellow-700">3. 結果：</span>
                上方的水銀無法回流，保留了<span class="underline">最高溫度讀數</span>。必須用力甩動才能使其歸位。
            </p>
        </div>
    </div>

    <script>
        // 狀態
        const state = {
            ambientTemp: 36.5,
            mercuryLevel: 36.5,
            isShaking: false
        };

        // 常數
        const MIN_TEMP = 35.0;
        const MAX_TEMP = 42.0;
        const RANGE = MAX_TEMP - MIN_TEMP;

        // DOM 元素
        const slider = document.getElementById('temp-slider');
        const displayAmbient = document.getElementById('display-ambient');
        const displayMercury = document.getElementById('display-mercury');
        const mercuryColumn = document.getElementById('mercury-column');
        const kinkMercury = document.getElementById('kink-mercury');
        const brokenIndicator = document.getElementById('broken-indicator');
        const warningBox = document.getElementById('warning-box');
        const shakeBtn = document.getElementById('shake-btn');
        const shakeText = document.getElementById('shake-text');
        const shakeHint = document.getElementById('shake-hint');
        const shakeIcon = document.getElementById('shake-icon');
        const thermometerContainer = document.getElementById('thermometer-container');

        // 初始化
        function init() {
            updateUI();
            
            // 滑桿事件
            slider.addEventListener('input', (e) => {
                const newAmbient = parseFloat(e.target.value);
                state.ambientTemp = newAmbient;
                
                // 物理邏輯
                if (state.ambientTemp > state.mercuryLevel) {
                    // 加熱：推升水銀
                    state.mercuryLevel = state.ambientTemp;
                }
                // 降溫：mercuryLevel 保持不變，UI 會處理斷裂顯示

                updateUI();
            });

            // 按鈕事件
            shakeBtn.addEventListener('click', handleShake);
        }

        // 甩動邏輯
        function handleShake() {
            if (state.isShaking) return;

            state.isShaking = true;
            updateUI(); // 更新按鈕狀態

            // 添加動畫 class
            thermometerContainer.classList.add('animate-shake');
            shakeIcon.classList.add('animate-spin');
            shakeText.innerText = '用力甩動中...';

            setTimeout(() => {
                // 甩動完成：重置讀數
                state.mercuryLevel = state.ambientTemp;
                state.isShaking = false;
                
                // 移除動畫 class
                thermometerContainer.classList.remove('animate-shake');
                shakeIcon.classList.remove('animate-spin');
                
                updateUI();
            }, 600);
        }

        // UI 更新邏輯
        function updateUI() {
            const isThreadBroken = state.ambientTemp < state.mercuryLevel;

            // 1. 數字顯示
            displayAmbient.innerText = state.ambientTemp.toFixed(1) + '°C';
            displayMercury.innerText = state.mercuryLevel.toFixed(1) + '°C';

            // 2. 水銀柱寬度計算
            const percentage = (state.mercuryLevel - MIN_TEMP) / RANGE;
            const width = Math.max(0, Math.min(100, percentage * 100));
            const svgWidth = 580 * (width / 100);
            mercuryColumn.setAttribute('width', svgWidth);

            // 3. 截流區水銀顯示 (斷裂邏輯)
            if (isThreadBroken) {
                kinkMercury.style.display = 'none'; // 隱藏截流區水銀
                brokenIndicator.style.display = 'block'; // 顯示斷裂警告
                warningBox.style.display = 'flex'; // 顯示文字警告
            } else {
                kinkMercury.style.display = 'block';
                brokenIndicator.style.display = 'none';
                warningBox.style.display = 'none';
            }

            // 4. 按鈕狀態
            if (state.isShaking) {
                shakeBtn.className = "w-full md:w-auto flex items-center justify-center gap-3 px-8 py-4 rounded-xl font-bold text-lg shadow-md transition-all bg-slate-100 text-slate-600 border border-slate-300 cursor-not-allowed";
                shakeText.innerText = "甩動中...";
            } else {
                // 如果斷裂或讀數高於環境 (需要甩動)
                if (isThreadBroken || state.mercuryLevel > state.ambientTemp) {
                    shakeBtn.className = "w-full md:w-auto flex items-center justify-center gap-3 px-8 py-4 rounded-xl font-bold text-lg shadow-md transition-all bg-blue-600 text-white hover:bg-blue-700 hover:shadow-xl transform hover:-translate-y-1 cursor-pointer";
                    shakeBtn.disabled = false;
                    shakeText.innerText = "甩動體溫計";
                    shakeHint.innerText = "將水銀甩回液泡，重置讀數";
                } else {
                    shakeBtn.className = "w-full md:w-auto flex items-center justify-center gap-3 px-8 py-4 rounded-xl font-bold text-lg shadow-md transition-all bg-slate-100 text-slate-400 border border-slate-200 cursor-default";
                    shakeBtn.disabled = false; // 讓它總是可以點擊以體驗動畫，但視覺上示弱
                    shakeText.innerText = "甩動體溫計";
                    shakeHint.innerText = "";
                }
            }
        }

        // 啟動
        init();

    </script>
</body>
</html>