<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èµ«ç¾…åœ– (Hertzsprung-Russell Diagram) æ¢ç´¢å™¨</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js for the Scatter Plot -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Google Fonts: Noto Sans TC for Traditional Chinese -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #0f172a; /* Slate 900 */
        }
        /* Custom scrollbar for the data panel */
        .custom-scroll::-webkit-scrollbar {
            width: 8px;
        }
        .custom-scroll::-webkit-scrollbar-track {
            background: #1e293b; 
        }
        .custom-scroll::-webkit-scrollbar-thumb {
            background: #475569; 
            border-radius: 4px;
        }
        .custom-scroll::-webkit-scrollbar-thumb:hover {
            background: #64748b; 
        }
    </style>
</head>
<body class="text-gray-200 h-screen flex flex-col overflow-hidden">

    <!-- Navbar -->
    <nav class="bg-slate-900 border-b border-slate-700 p-4 shadow-lg z-10 flex justify-between items-center">
        <div class="flex items-center gap-3">
            <div class="w-8 h-8 rounded-full bg-gradient-to-tr from-blue-500 to-yellow-400 animate-pulse"></div>
            <h1 class="text-xl md:text-2xl font-bold text-white tracking-wide">
                HR Diagram 
                <span id="nav-subtitle" class="text-slate-400 text-sm font-normal ml-2">èµ«ç¾…åœ–æ†æ˜Ÿæ¢ç´¢å™¨</span>
            </h1>
        </div>
        <div class="flex items-center gap-3">
            <div id="nav-version" class="text-xs text-slate-500 hidden md:block">
                å¤©æ–‡è§€æ¸¬æ•¸æ“šåº« v1.0
            </div>
            
            <!-- åŸç†è§£èªªæŒ‰éˆ• -->
            <button onclick="toggleInfoModal(true)" class="bg-blue-600 hover:bg-blue-500 text-white text-sm px-3 py-2 rounded shadow transition-colors flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                <span id="btn-explain-text">åŸç†è§£èªª</span>
            </button>

            <!-- æ–°å¢: ç”Ÿå‘½é€±æœŸæŒ‰éˆ• -->
            <button onclick="toggleLifecycleModal(true)" class="bg-indigo-600 hover:bg-indigo-500 text-white text-sm px-3 py-2 rounded shadow transition-colors flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                </svg>
                <span id="btn-lifecycle-text">ç”Ÿå‘½é€±æœŸ</span>
            </button>

            <!-- èªè¨€åˆ‡æ›æŒ‰éˆ• -->
            <button onclick="toggleLanguage()" class="bg-slate-700 hover:bg-slate-600 text-white text-sm px-3 py-2 rounded shadow transition-colors font-mono border border-slate-600">
                ä¸­ / Eng
            </button>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="flex-1 flex flex-col md:flex-row h-full overflow-hidden relative">
        
        <!-- Left: Chart Area -->
        <div class="w-full md:w-2/3 lg:w-3/4 p-4 flex flex-col relative bg-slate-950">
            <!-- Background Stars Animation Layer -->
            <div class="absolute inset-0 z-0 opacity-20 pointer-events-none" style="background-image: radial-gradient(white 1px, transparent 1px); background-size: 50px 50px;"></div>

            <div class="relative z-10 w-full h-full flex items-center justify-center p-2 border border-slate-800 rounded-lg bg-slate-900/50 backdrop-blur-sm shadow-inner">
                <canvas id="hrChart"></canvas>
            </div>
            
            <div class="mt-2 text-center text-xs text-slate-500 z-10">
                <span class="inline-block w-3 h-3 bg-blue-400 rounded-full mr-1"></span><span id="legend-ms">ä¸»åºæ˜Ÿ</span>
                <span class="inline-block w-3 h-3 bg-red-500 rounded-full ml-3 mr-1"></span><span id="legend-giant">å·¨æ˜Ÿ/è¶…å·¨æ˜Ÿ</span>
                <span class="inline-block w-3 h-3 bg-white rounded-full ml-3 mr-1"></span><span id="legend-wd">ç™½çŸ®æ˜Ÿ</span>
                <p id="chart-tip" class="mt-1">é»æ“Šåœ–è¡¨ä¸­çš„æ˜Ÿé»ä»¥æŸ¥çœ‹è©³æƒ…</p>
            </div>
        </div>

        <!-- Right: Info Panel -->
        <div class="w-full md:w-1/3 lg:w-1/4 bg-slate-800 border-l border-slate-700 p-6 flex flex-col shadow-2xl z-20 custom-scroll overflow-y-auto">
            
            <div id="empty-state" class="flex flex-col items-center justify-center h-full text-slate-400 opacity-70">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z" />
                </svg>
                <p id="empty-text-1">è«‹åœ¨å·¦å´åœ–è¡¨ä¸­</p>
                <p id="empty-text-2">é¸æ“‡ä¸€é¡†æ†æ˜Ÿ</p>
            </div>

            <div id="star-details" class="hidden transition-all duration-300 ease-in-out">
                <div class="mb-6 pb-4 border-b border-slate-600">
                    <h2 id="star-name" class="text-3xl font-bold text-white mb-1">Star Name</h2>
                    <p class="text-blue-300 font-mono text-sm"><span id="lbl-spec-type">å…‰è­œé¡å‹:</span> <span id="star-type"></span></p>
                </div>

                <div class="space-y-4">
                    <!-- Physical Properties -->
                    <div>
                        <h3 id="lbl-phys-prop" class="text-xs font-semibold text-slate-400 uppercase tracking-wider mb-2">ç‰©ç†æ€§è³ª</h3>
                        <div class="grid grid-cols-2 gap-3">
                            <div class="bg-slate-700/50 p-3 rounded hover:bg-slate-700 transition">
                                <p id="lbl-temp" class="text-xs text-slate-400">è¡¨é¢æº«åº¦ (K)</p>
                                <p id="star-temp" class="text-lg font-mono text-white">0</p>
                            </div>
                            <div class="bg-slate-700/50 p-3 rounded hover:bg-slate-700 transition">
                                <p id="lbl-lum" class="text-xs text-slate-400">å…‰åº¦ (Lâ˜‰)</p>
                                <p id="star-lum" class="text-lg font-mono text-white">0</p>
                            </div>
                            <div class="bg-slate-700/50 p-3 rounded hover:bg-slate-700 transition">
                                <p id="lbl-rad" class="text-xs text-slate-400">åŠå¾‘ (Râ˜‰)</p>
                                <p id="star-radius" class="text-lg font-mono text-white">0</p>
                            </div>
                            <div class="bg-slate-700/50 p-3 rounded hover:bg-slate-700 transition">
                                <p id="lbl-color" class="text-xs text-slate-400">é¡è‰²æŒ‡æ•¸ (B-V)</p>
                                <p id="star-bv" class="text-lg font-mono text-white">0</p>
                            </div>
                        </div>
                    </div>

                    <!-- Coordinates Section Removed -->
                    
                    <!-- Nature/Description -->
                    <div class="mt-6">
                        <h3 id="lbl-desc" class="text-xs font-semibold text-slate-400 uppercase tracking-wider mb-2">æ˜Ÿé«”æœ¬è³ªèˆ‡å‚™è¨»</h3>
                        <p id="star-desc" class="text-sm text-slate-300 leading-relaxed bg-slate-700/30 p-3 rounded">
                            --
                        </p>
                    </div>

                    <!-- Visual Representation Placeholder -->
                    <div class="mt-6 flex justify-center items-center h-24 bg-black rounded-lg relative overflow-hidden">
                         <div id="star-visual" class="rounded-full shadow-[0_0_20px_rgba(255,255,255,0.5)] transition-all duration-500"></div>
                         <p id="lbl-visual" class="absolute bottom-1 right-2 text-[10px] text-slate-600">ç¤ºæ„åœ– (éæ¯”ä¾‹)</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- åŸç†è§£èªª Modal -->
    <div id="infoModal" class="fixed inset-0 bg-black/80 z-50 hidden flex items-center justify-center p-4 backdrop-blur-sm transition-opacity duration-300">
        <div class="bg-slate-800 border border-slate-600 rounded-lg shadow-2xl w-full max-w-3xl max-h-[90vh] flex flex-col relative">
            
            <!-- Modal Header -->
            <div class="flex justify-between items-center p-6 border-b border-slate-700 bg-slate-800/50">
                <h2 id="modal-title" class="text-2xl font-bold text-white flex items-center gap-2">
                    <!-- Icon injected via JS -->
                    èµ«ç¾…åœ– (H-R Diagram) åŸç†è§£æ
                </h2>
                <button onclick="toggleInfoModal(false)" class="text-slate-400 hover:text-white transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>

            <!-- Modal Body -->
            <div id="modal-content" class="p-6 overflow-y-auto custom-scroll text-slate-300 leading-relaxed space-y-6">
                <!-- Content injected via JS -->
            </div>

            <!-- Modal Footer -->
            <div class="p-4 border-t border-slate-700 bg-slate-800/50 flex justify-end">
                <button id="btn-close" onclick="toggleInfoModal(false)" class="bg-slate-600 hover:bg-slate-500 text-white px-6 py-2 rounded transition-colors">
                    é—œé–‰
                </button>
            </div>
        </div>
    </div>

    <!-- æ–°å¢: ç”Ÿå‘½é€±æœŸ Modal -->
    <div id="lifecycleModal" class="fixed inset-0 bg-black/80 z-50 hidden flex items-center justify-center p-4 backdrop-blur-sm transition-opacity duration-300">
        <div class="bg-slate-800 border border-indigo-500/50 rounded-lg shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col relative">
            
            <!-- Modal Header -->
            <div class="flex justify-between items-center p-6 border-b border-slate-700 bg-slate-800/50">
                <h2 id="lifecycle-title" class="text-2xl font-bold text-white flex items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-indigo-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                         <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                    </svg>
                    æ†æ˜Ÿçš„ç”Ÿå‘½é€±æœŸ
                </h2>
                <button onclick="toggleLifecycleModal(false)" class="text-slate-400 hover:text-white transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>

            <!-- Modal Body -->
            <div id="lifecycle-content" class="p-6 overflow-y-auto custom-scroll text-slate-300 leading-relaxed space-y-6">
                <!-- Content injected via JS -->
            </div>

             <!-- Modal Footer -->
            <div class="p-4 border-t border-slate-700 bg-slate-800/50 flex justify-end">
                <button id="btn-close-lifecycle" onclick="toggleLifecycleModal(false)" class="bg-indigo-600 hover:bg-indigo-500 text-white px-6 py-2 rounded transition-colors">
                    é—œé–‰
                </button>
            </div>
        </div>
    </div>


    <!-- JavaScript Logic -->
    <script>
        // --- 0. å¤šèªè¨€é…ç½® (i18n) ---
        let currentLang = 'zh'; // 'zh' or 'en'

        const i18n = {
            zh: {
                subtitle: "èµ«ç¾…åœ–æ†æ˜Ÿæ¢ç´¢å™¨",
                version: "å¤©æ–‡è§€æ¸¬æ•¸æ“šåº« v1.0",
                btnExplain: "åŸç†è§£èªª",
                btnLifecycle: "ç”Ÿå‘½é€±æœŸ", // New
                btnClose: "é—œé–‰",
                legendMS: "ä¸»åºæ˜Ÿ",
                legendGiant: "å·¨æ˜Ÿ/è¶…å·¨æ˜Ÿ",
                legendWD: "ç™½çŸ®æ˜Ÿ",
                chartTip: "é»æ“Šåœ–è¡¨ä¸­çš„æ˜Ÿé»ä»¥æŸ¥çœ‹è©³æƒ…",
                empty1: "è«‹åœ¨å·¦å´åœ–è¡¨ä¸­",
                empty2: "é¸æ“‡ä¸€é¡†æ†æ˜Ÿ",
                lblSpecType: "å…‰è­œé¡å‹:",
                lblPhysProp: "ç‰©ç†æ€§è³ª",
                lblTemp: "è¡¨é¢æº«åº¦ (K)",
                lblLum: "å…‰åº¦ (Lâ˜‰)",
                lblRad: "åŠå¾‘ (Râ˜‰)",
                lblColor: "é¡è‰²æŒ‡æ•¸ (B-V)",
                lblDesc: "æ˜Ÿé«”æœ¬è³ªèˆ‡å‚™è¨»",
                lblVisual: "ç¤ºæ„åœ– (éæ¯”ä¾‹)",
                axisX: "è¡¨é¢æº«åº¦ (K) [åå‘, å°æ•¸å°ºåº¦]",
                axisY: "å…‰åº¦ (Lâ˜‰ - å¤ªé™½å…‰åº¦)",
                modalTitle: "èµ«ç¾…åœ– (H-R Diagram) åŸç†è§£æ",
                modalBody: `
                    <section>
                        <h3 class="text-lg font-bold text-blue-300 mb-2">1. ç”šéº¼æ˜¯èµ«ç¾…åœ–ï¼Ÿ</h3>
                        <p>èµ«ç¾…åœ– (Hertzsprung-Russell diagram) æ˜¯å¤©æ–‡å­¸ä¸­æœ€è‘—åçš„çµ±è¨ˆåœ–è¡¨ã€‚å®ƒä¸¦ä¸æç¹ªæ˜Ÿæ˜Ÿåœ¨å¤©ç©ºä¸­çš„ä½ç½®ï¼Œè€Œæ˜¯å±•ç¤ºäº†æ†æ˜Ÿçš„<strong class="text-white">å…‰åº¦ï¼ˆäº®åº¦ï¼‰</strong>èˆ‡<strong class="text-white">è¡¨é¢æº«åº¦ï¼ˆé¡è‰²ï¼‰</strong>ä¹‹é–“çš„é—œä¿‚ã€‚</p>
                    </section>
                    <div class="grid md:grid-cols-2 gap-6">
                        <section>
                            <h3 class="text-lg font-bold text-blue-300 mb-2">2. åœ–è¡¨çš„æè¿°</h3>
                            <ul class="list-disc list-inside space-y-1 text-sm">
                                <li><strong class="text-white">æ©«è»¸ (X)ï¼š</strong> ä»£è¡¨è¡¨é¢æº«åº¦ã€‚æ³¨æ„ï¼Œ<span class="text-yellow-400">æº«åº¦æ˜¯åå‘æ’åˆ—çš„</span>ï¼Œå·¦é‚Šæ˜¯é«˜æº«ï¼ˆè—è‰²ï¼‰ï¼Œå³é‚Šæ˜¯ä½æº«ï¼ˆç´…è‰²ï¼‰ã€‚</li>
                                <li><strong class="text-white">ç¸±è»¸ (Y)ï¼š</strong> ä»£è¡¨å…‰åº¦ï¼Œå³æ†æ˜ŸçœŸå¯¦çš„ç™¼å…‰èƒ½åŠ›ã€‚é€™æ˜¯å°æ•¸å°ºåº¦ã€‚</li>
                            </ul>
                        </section>
                        <section>
                            <h3 class="text-lg font-bold text-blue-300 mb-2">3. é‡è¦çš„å¤©æ–‡è¨Šæ¯</h3>
                            <p class="text-sm">æ†æ˜Ÿä¸æ˜¯éš¨æ©Ÿåˆ†ä½ˆçš„ï¼Œè€Œæ˜¯èšé›†åœ¨ç‰¹å®šå€åŸŸï¼ˆå¦‚ä¸»åºå¸¶ï¼‰ã€‚é€™é¡¯ç¤ºæ†æ˜Ÿçš„æ€§è³ªå¿…é ˆéµå®ˆç‰¹å®šçš„ç‰©ç†æ³•å‰‡ï¼Œä¸”æœƒéš¨è‘—å¹´é½¡æ”¹è®Šä½ç½®ã€‚</p>
                        </section>
                    </div>
                    <section class="bg-slate-700/30 p-4 rounded-lg border-l-4 border-blue-500">
                        <h3 class="text-lg font-bold text-blue-300 mb-2">4. å°å¤©æ–‡å­¸å®¶çš„ç”¨é€”</h3>
                        <ul class="space-y-2 text-sm">
                            <li>ğŸ”­ <strong class="text-white">æ¨ç®—è·é›¢ï¼š</strong> åˆ©ç”¨ä¸»åºæ˜Ÿæ“¬åˆæ³•ã€‚</li>
                            <li>â³ <strong class="text-white">æ¸¬å®šå¹´é½¡ï¼š</strong> è§€å¯Ÿæ˜Ÿåœ˜ä¸»åºæ˜Ÿçš„æ‹é»ã€‚</li>
                            <li>ğŸŒŸ <strong class="text-white">ç ”ç©¶æ¼”åŒ–ï¼š</strong> è¿½è¹¤æ†æ˜Ÿçš„ç”Ÿå‘½è»Œè·¡ã€‚</li>
                        </ul>
                    </section>
                    <section>
                        <h3 class="text-lg font-bold text-blue-300 mb-4">5. åœ–ä¸­æ˜Ÿé«”çš„åˆ†é¡</h3>
                        <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
                            <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                <h4 class="font-bold text-white mb-1"><span class="w-2 h-2 rounded-full bg-blue-400 inline-block mr-2"></span>ä¸»åºæ˜Ÿ</h4>
                                <p class="text-xs">åŒ…å«90%çš„æ†æ˜Ÿï¼ˆå¦‚å¤ªé™½ï¼‰ï¼Œæ­£ç©©å®šç‡ƒç‡’æ°«æ°£ã€‚</p>
                            </div>
                            <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                <h4 class="font-bold text-white mb-1"><span class="w-2 h-2 rounded-full bg-red-500 inline-block mr-2"></span>å·¨æ˜Ÿ/è¶…å·¨æ˜Ÿ</h4>
                                <p class="text-xs">é«”ç©é¾å¤§ï¼Œç€•è‡¨æ­»äº¡çš„è†¨è„¹æ†æ˜Ÿã€‚</p>
                            </div>
                            <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                <h4 class="font-bold text-white mb-1"><span class="w-2 h-2 rounded-full bg-white inline-block mr-2"></span>ç™½çŸ®æ˜Ÿ</h4>
                                <p class="text-xs">é«”ç©å°ã€æº«åº¦é«˜ï¼Œæ†æ˜Ÿæ­»äº¡å¾Œçš„æ®˜éª¸ã€‚</p>
                            </div>
                        </div>
                    </section>
                `,
                // New: Lifecycle Modal Content
                modalLifecycleTitle: "æ†æ˜Ÿçš„æ¼”åŒ–èˆ‡ç”Ÿå‘½é€±æœŸ",
                modalLifecycleBody: `
                    <div class="space-y-8">
                        <!-- Stage 1: Birth -->
                        <div class="relative pl-8 border-l-2 border-slate-600">
                            <div class="absolute -left-[9px] top-0 w-4 h-4 rounded-full bg-blue-500"></div>
                            <h3 class="text-xl font-bold text-white mb-2">1. èª•ç”Ÿ (Birth)</h3>
                            <p class="text-sm text-slate-400 mb-2">åˆ†å­é›²å¡Œç¸® -> åŸæ†æ˜Ÿ</p>
                            <p>æ†æ˜Ÿèª•ç”Ÿæ–¼å·¨å¤§çš„æ˜Ÿéš›æ°£é«”å’Œå¡µåŸƒé›²ï¼ˆæ˜Ÿé›²ï¼‰ã€‚ç•¶é‡åŠ›å°è‡´é›²åœ˜å¡Œç¸®ï¼Œä¸­å¿ƒæº«åº¦å‡é«˜ï¼Œå½¢æˆ<strong class="text-white">åŸæ†æ˜Ÿ</strong>ã€‚ç•¶æ ¸å¿ƒæº«åº¦è¶³ä»¥å¼•ç™¼æ ¸èåˆæ™‚ï¼Œä¸€é¡†æ†æ˜Ÿå°±æ­¤èª•ç”Ÿã€‚</p>
                        </div>

                        <!-- Stage 2: Main Sequence -->
                        <div class="relative pl-8 border-l-2 border-slate-600">
                            <div class="absolute -left-[9px] top-0 w-4 h-4 rounded-full bg-yellow-400"></div>
                            <h3 class="text-xl font-bold text-white mb-2">2. ä¸»åºæ˜Ÿéšæ®µ (Main Sequence)</h3>
                            <p class="text-sm text-slate-400 mb-2">ç©©å®šç‡ƒç‡’æ°«æ°£ (å¦‚ï¼šå¤ªé™½)</p>
                            <p>é€™æ˜¯æ†æ˜Ÿç”Ÿå‘½ä¸­æœ€é•·çš„ä¸€æ®µæ™‚æœŸã€‚æ†æ˜Ÿåœ¨æ ¸å¿ƒå°‡æ°«èåˆæˆæ°¦ï¼Œç”¢ç”Ÿçš„èƒ½é‡æŠµæŠ—é‡åŠ›ï¼Œä¿æŒç©©å®šã€‚èµ«ç¾…åœ–ä¸Šé‚£æ¢å¾å·¦ä¸Šåˆ°å³ä¸‹çš„å¸¶ç‹€å€åŸŸå°±æ˜¯ä¸»åºå¸¶ã€‚</p>
                        </div>

                        <!-- Stage 3: Death (Divergence) -->
                        <div class="grid md:grid-cols-2 gap-6 mt-4">
                            <!-- Low Mass Path -->
                            <div class="bg-slate-900/50 p-4 rounded-lg border border-slate-700">
                                <h4 class="text-lg font-bold text-orange-300 mb-3">ä½è³ªé‡æ†æ˜Ÿ (å¦‚å¤ªé™½)</h4>
                                <ul class="space-y-3">
                                    <li class="flex items-start">
                                        <span class="text-red-500 font-bold mr-2">â†’</span>
                                        <div>
                                            <strong class="text-white">ç´…å·¨æ˜Ÿ (Red Giant):</strong><br>
                                            æ°«ç‡ƒæ–™è€—ç›¡ï¼Œæ ¸å¿ƒå¡Œç¸®ä½†å¤–å±¤è†¨è„¹ä¸¦å†·å»è®Šç´…ã€‚
                                        </div>
                                    </li>
                                    <li class="flex items-start">
                                        <span class="text-purple-400 font-bold mr-2">â†’</span>
                                        <div>
                                            <strong class="text-white">è¡Œæ˜Ÿç‹€æ˜Ÿé›² (Planetary Nebula):</strong><br>
                                            å¤–å±¤å¤§æ°£è¢«æ‹‹å…¥å¤ªç©ºï¼Œå½¢æˆç¾éº—çš„æ°£æ®¼ã€‚
                                        </div>
                                    </li>
                                    <li class="flex items-start">
                                        <span class="text-white font-bold mr-2">â†’</span>
                                        <div>
                                            <strong class="text-white">ç™½çŸ®æ˜Ÿ (White Dwarf):</strong><br>
                                            ç•™ä¸‹çš„æ ¸å¿ƒï¼Œé«”ç©å°å¦‚åœ°çƒä½†æ¥µç†±ï¼Œæœ€çµ‚æ…¢æ…¢å†·å»æ¶ˆå¤±ã€‚
                                        </div>
                                    </li>
                                </ul>
                            </div>

                            <!-- High Mass Path -->
                            <div class="bg-slate-900/50 p-4 rounded-lg border border-slate-700">
                                <h4 class="text-lg font-bold text-blue-300 mb-3">é«˜è³ªé‡æ†æ˜Ÿ (>8å€å¤ªé™½è³ªé‡)</h4>
                                <ul class="space-y-3">
                                    <li class="flex items-start">
                                        <span class="text-red-500 font-bold mr-2">â†’</span>
                                        <div>
                                            <strong class="text-white">ç´…è¶…å·¨æ˜Ÿ (Red Supergiant):</strong><br>
                                            é«”ç©å·¨å¤§ï¼Œæ ¸å¿ƒé€²è¡Œæ›´é‡çš„å…ƒç´ èåˆï¼ˆç¢³ã€æ°–...ç›´åˆ°éµï¼‰ã€‚
                                        </div>
                                    </li>
                                    <li class="flex items-start">
                                        <span class="text-yellow-500 font-bold mr-2">â†’</span>
                                        <div>
                                            <strong class="text-white">è¶…æ–°æ˜Ÿçˆ†ç‚¸ (Supernova):</strong><br>
                                            éµæ ¸ç„¡æ³•èåˆç”¢ç”Ÿèƒ½é‡ï¼Œæ†æ˜Ÿç¬é–“å¡Œç¸®ä¸¦çŒ›çƒˆçˆ†ç‚¸ï¼Œäº®åº¦å¯æ¯”æ“¬æ•´å€‹æ˜Ÿç³»ã€‚
                                        </div>
                                    </li>
                                    <li class="flex items-start">
                                        <span class="text-cyan-400 font-bold mr-2">â†’</span>
                                        <div>
                                            <strong class="text-white">ä¸­å­æ˜Ÿæˆ–é»‘æ´:</strong><br>
                                            æ¥µåº¦ç·»å¯†çš„æ®˜éª¸ã€‚è³ªé‡æœ€å¤§çš„æ†æ˜Ÿå°‡å¡Œç¸®æˆé€£å…‰éƒ½ç„¡æ³•é€ƒè„«çš„é»‘æ´ã€‚
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                `
            },
            en: {
                subtitle: "Stellar Explorer",
                version: "Astronomical Database v1.0",
                btnExplain: "Explanation",
                btnLifecycle: "Lifecycle", // New
                btnClose: "Close",
                legendMS: "Main Sequence",
                legendGiant: "Giants/Supergiants",
                legendWD: "White Dwarfs",
                chartTip: "Click on a star to view details",
                empty1: "Please select a star",
                empty2: "from the chart on the left",
                lblSpecType: "Spectral Type:",
                lblPhysProp: "Physical Properties",
                lblTemp: "Surface Temp (K)",
                lblLum: "Luminosity (Lâ˜‰)",
                lblRad: "Radius (Râ˜‰)",
                lblColor: "Color Index (B-V)",
                lblDesc: "Nature & Notes",
                lblVisual: "Illustration (Not to scale)",
                axisX: "Surface Temperature (K) [Reverse, Log Scale]",
                axisY: "Luminosity (Lâ˜‰ - Solar Luminosity)",
                modalTitle: "Understanding the H-R Diagram",
                modalBody: `
                    <section>
                        <h3 class="text-lg font-bold text-blue-300 mb-2">1. What is the H-R Diagram?</h3>
                        <p>The Hertzsprung-Russell diagram is a famous scatter plot of stars showing the relationship between their stars' <strong class="text-white">luminosity</strong> and their <strong class="text-white">temperature</strong>.</p>
                    </section>
                    <div class="grid md:grid-cols-2 gap-6">
                        <section>
                            <h3 class="text-lg font-bold text-blue-300 mb-2">2. Description</h3>
                            <ul class="list-disc list-inside space-y-1 text-sm">
                                <li><strong class="text-white">X-Axis:</strong> Surface Temperature. Note that <span class="text-yellow-400">temperature is plotted backwards</span> (Hot/Blue on left, Cold/Red on right).</li>
                                <li><strong class="text-white">Y-Axis:</strong> Luminosity (brightness relative to Sun) on a logarithmic scale.</li>
                            </ul>
                        </section>
                        <section>
                            <h3 class="text-lg font-bold text-blue-300 mb-2">3. Key Insights</h3>
                            <p class="text-sm">Stars are not randomly distributed but cluster in specific regions (like the Main Sequence), implying they follow specific physical laws and evolutionary paths.</p>
                        </section>
                    </div>
                    <section class="bg-slate-700/30 p-4 rounded-lg border-l-4 border-blue-500">
                        <h3 class="text-lg font-bold text-blue-300 mb-2">4. Use in Astronomy</h3>
                        <ul class="space-y-2 text-sm">
                            <li>ğŸ”­ <strong class="text-white">Distance:</strong> Estimating distance via spectroscopic parallax.</li>
                            <li>â³ <strong class="text-white">Age:</strong> Determining the age of star clusters via the "turn-off point".</li>
                            <li>ğŸŒŸ <strong class="text-white">Evolution:</strong> Tracking a star's life cycle.</li>
                        </ul>
                    </section>
                    <section>
                        <h3 class="text-lg font-bold text-blue-300 mb-4">5. Stellar Classification</h3>
                        <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
                            <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                <h4 class="font-bold text-white mb-1"><span class="w-2 h-2 rounded-full bg-blue-400 inline-block mr-2"></span>Main Sequence</h4>
                                <p class="text-xs">90% of stars (like the Sun), fusing hydrogen stably.</p>
                            </div>
                            <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                <h4 class="font-bold text-white mb-1"><span class="w-2 h-2 rounded-full bg-red-500 inline-block mr-2"></span>Giants</h4>
                                <p class="text-xs">Large, dying stars that have expanded.</p>
                            </div>
                            <div class="bg-slate-900 p-3 rounded border border-slate-700">
                                <h4 class="font-bold text-white mb-1"><span class="w-2 h-2 rounded-full bg-white inline-block mr-2"></span>White Dwarfs</h4>
                                <p class="text-xs">Small, hot, dense remnants of dead stars.</p>
                            </div>
                        </div>
                    </section>
                `,
                // New: Lifecycle Modal Content
                modalLifecycleTitle: "Stellar Evolution & Lifecycle",
                modalLifecycleBody: `
                    <div class="space-y-8">
                        <!-- Stage 1: Birth -->
                        <div class="relative pl-8 border-l-2 border-slate-600">
                            <div class="absolute -left-[9px] top-0 w-4 h-4 rounded-full bg-blue-500"></div>
                            <h3 class="text-xl font-bold text-white mb-2">1. Birth</h3>
                            <p class="text-sm text-slate-400 mb-2">Cloud Collapse -> Protostar</p>
                            <p>Stars are born in giant clouds of gas and dust (nebulae). As gravity causes the cloud to collapse, the center heats up to form a <strong class="text-white">Protostar</strong>. When the core is hot enough for nuclear fusion, a star is born.</p>
                        </div>

                        <!-- Stage 2: Main Sequence -->
                        <div class="relative pl-8 border-l-2 border-slate-600">
                            <div class="absolute -left-[9px] top-0 w-4 h-4 rounded-full bg-yellow-400"></div>
                            <h3 class="text-xl font-bold text-white mb-2">2. Main Sequence</h3>
                            <p class="text-sm text-slate-400 mb-2">Stable Hydrogen Fusion (e.g., The Sun)</p>
                            <p>The longest phase of a star's life. It fuses hydrogen into helium in its core. The outward pressure of energy balances gravity. This is the diagonal band on the H-R Diagram.</p>
                        </div>

                        <!-- Stage 3: Death (Divergence) -->
                        <div class="grid md:grid-cols-2 gap-6 mt-4">
                            <!-- Low Mass Path -->
                            <div class="bg-slate-900/50 p-4 rounded-lg border border-slate-700">
                                <h4 class="text-lg font-bold text-orange-300 mb-3">Low Mass Stars (like Sun)</h4>
                                <ul class="space-y-3">
                                    <li class="flex items-start">
                                        <span class="text-red-500 font-bold mr-2">â†’</span>
                                        <div>
                                            <strong class="text-white">Red Giant:</strong><br>
                                            Hydrogen runs out, core collapses, outer layers expand and cool.
                                        </div>
                                    </li>
                                    <li class="flex items-start">
                                        <span class="text-purple-400 font-bold mr-2">â†’</span>
                                        <div>
                                            <strong class="text-white">Planetary Nebula:</strong><br>
                                            Outer atmosphere is ejected into space, forming a glowing shell.
                                        </div>
                                    </li>
                                    <li class="flex items-start">
                                        <span class="text-white font-bold mr-2">â†’</span>
                                        <div>
                                            <strong class="text-white">White Dwarf:</strong><br>
                                            The remaining hot, dense core. Earth-sized but massive.
                                        </div>
                                    </li>
                                </ul>
                            </div>

                            <!-- High Mass Path -->
                            <div class="bg-slate-900/50 p-4 rounded-lg border border-slate-700">
                                <h4 class="text-lg font-bold text-blue-300 mb-3">High Mass Stars (>8x Sun)</h4>
                                <ul class="space-y-3">
                                    <li class="flex items-start">
                                        <span class="text-red-500 font-bold mr-2">â†’</span>
                                        <div>
                                            <strong class="text-white">Red Supergiant:</strong><br>
                                            Huge expansion. Fuses heavier elements (Carbon... up to Iron).
                                        </div>
                                    </li>
                                    <li class="flex items-start">
                                        <span class="text-yellow-500 font-bold mr-2">â†’</span>
                                        <div>
                                            <strong class="text-white">Supernova:</strong><br>
                                            Iron core collapses instantly, causing a massive explosion brighter than a galaxy.
                                        </div>
                                    </li>
                                    <li class="flex items-start">
                                        <span class="text-cyan-400 font-bold mr-2">â†’</span>
                                        <div>
                                            <strong class="text-white">Neutron Star or Black Hole:</strong><br>
                                            Extremely dense remnants. The most massive stars become Black Holes.
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                `
            }
        };

        // --- 1. Data Dataset (Updated with English Descriptions) ---
        const starsData = [
            // --- åŸå§‹æ•¸æ“š ---
            { name: "å¤ªé™½ (Sun)", temp: 5778, lum: 1, radius: 1, ra: "00h 00m 00s", dec: "+00Â° 00' 00\"", type: "G2V", desc: "æˆ‘å€‘å¤ªé™½ç³»ä¸­å¿ƒçš„æ†æ˜Ÿï¼Œä½æ–¼ä¸»åºå¸¶çš„é»ƒçŸ®æ˜Ÿã€‚ç”Ÿå‘½èˆ‡æ–‡æ˜çš„æºé ­ã€‚", desc_en: "The star at the center of our Solar System. A yellow dwarf on the main sequence. The source of life and civilization." },
            { name: "å¤©ç‹¼æ˜Ÿ A (Sirius A)", temp: 9940, lum: 25.4, radius: 1.71, ra: "06h 45m 08s", dec: "-16Â° 42' 58\"", type: "A1V", desc: "å¤œç©ºä¸­æœ€äº®çš„æ†æ˜Ÿã€‚è·é›¢åœ°çƒç´„ 8.6 å…‰å¹´ã€‚å®ƒæœ‰ä¸€é¡†ç™½çŸ®æ˜Ÿä¼´æ˜Ÿã€‚", desc_en: "Brightest star in the night sky. About 8.6 light-years away. It has a white dwarf companion." },
            { name: "åƒå®¿å›› (Betelgeuse)", temp: 3500, lum: 126000, radius: 887, ra: "05h 55m 10s", dec: "+07Â° 24' 25\"", type: "M1-M2Ia-ab", desc: "è‘—åçš„ç´…è¶…å·¨æ˜Ÿï¼Œä½æ–¼çµæˆ¶åº§è‚©è†€ã€‚é«”ç©å·¨å¤§ï¼Œå¦‚æœæ”¾åœ¨å¤ªé™½ç³»ä¸­å¿ƒï¼Œå…¶é‚Šç·£å°‡åæ²’æœ¨æ˜Ÿè»Œé“ã€‚", desc_en: "Famous red supergiant in Orion. It is huge; if placed at the center of the solar system, it would engulf Jupiter's orbit." },
            { name: "åƒå®¿ä¸ƒ (Rigel)", temp: 12100, lum: 120000, radius: 78.9, ra: "05h 14m 32s", dec: "-08Â° 12' 05\"", type: "B8Ia", desc: "è—è¶…å·¨æ˜Ÿï¼Œçµæˆ¶åº§ä¸­æœ€äº®çš„æ˜Ÿã€‚é›–ç„¶å¹´è¼•ï¼Œä½†ç‡ƒç‡’åŠ‡çƒˆï¼Œå£½å‘½å°‡é çŸ­æ–¼å¤ªé™½ã€‚", desc_en: "Blue supergiant, brightest in Orion. Though young, it burns furiously and will have a much shorter life than the Sun." },
            { name: "æ¯”é„°æ˜Ÿ (Proxima Centauri)", temp: 3042, lum: 0.0017, radius: 0.15, ra: "14h 29m 43s", dec: "-62Â° 40' 46\"", type: "M5.5Ve", desc: "è·é›¢å¤ªé™½ç³»æœ€è¿‘çš„æ†æ˜Ÿï¼ˆ4.24å…‰å¹´ï¼‰ï¼Œæ˜¯ä¸€é¡†ç´…çŸ®æ˜Ÿã€‚å…‰åº¦æ¥µä½ï¼Œè‚‰çœ¼ç„¡æ³•çœ‹è¦‹ã€‚", desc_en: "Closest star to the Solar System (4.24 ly). A red dwarf, too faint to be seen with the naked eye." },
            { name: "ç¹”å¥³æ˜Ÿ (Vega)", temp: 9602, lum: 40.12, radius: 2.36, ra: "18h 36m 56s", dec: "+38Â° 47' 01\"", type: "A0V", desc: "å¤©ç´åº§æœ€äº®çš„æ˜Ÿï¼Œå¤å­£å¤§ä¸‰è§’ä¹‹ä¸€ã€‚å®ƒæ˜¯å¤©æ–‡å­¸æ ¡æº–å…‰åº¦çš„æ¨™æº–æ˜Ÿä¹‹ä¸€ã€‚", desc_en: "Brightest star in Lyra, part of the Summer Triangle. Used as a standard star for calibrating brightness." },
            { name: "å¤§è§’æ˜Ÿ (Arcturus)", temp: 4286, lum: 170, radius: 25.4, ra: "14h 15m 39s", dec: "+19Â° 10' 56\"", type: "K0III", desc: "ç´…å·¨æ˜Ÿï¼ŒåŒ—åŠçƒå¤œç©ºä¸­æœ€äº®çš„æ†æ˜Ÿä¹‹ä¸€ã€‚å¹´é½¡æ¯”å¤ªé™½è€ï¼Œå·²è„«é›¢ä¸»åºå¸¶ã€‚", desc_en: "Red giant, one of the brightest stars in the northern hemisphere. Older than the Sun and has left the main sequence." },
            { name: "å¤©ç‹¼æ˜Ÿ B (Sirius B)", temp: 25200, lum: 0.056, radius: 0.0084, ra: "06h 45m 09s", dec: "-16Â° 43' 06\"", type: "DA2", desc: "å¤©ç‹¼æ˜Ÿçš„ä¼´æ˜Ÿï¼Œä¸€é¡†ç™½çŸ®æ˜Ÿã€‚é«”ç©èˆ‡åœ°çƒç›¸ç•¶ï¼Œä½†è³ªé‡æ¥è¿‘å¤ªé™½ï¼Œå¯†åº¦æ¥µé«˜ã€‚", desc_en: "Companion to Sirius A, a white dwarf. Size of Earth but mass comparable to the Sun. Extremely dense." },
            { name: "è€äººæ˜Ÿ (Canopus)", temp: 7350, lum: 10700, radius: 71, ra: "06h 23m 57s", dec: "-52Â° 41' 44\"", type: "A9II", desc: "å…¨å¤©ç¬¬äºŒäº®æ˜Ÿï¼Œå±¬æ–¼äº®å·¨æ˜Ÿæˆ–è¶…å·¨æ˜Ÿã€‚å¸¸ç”¨æ–¼å¤ªç©ºæ¢æ¸¬å™¨çš„å°èˆªåƒè€ƒé»ã€‚", desc_en: "Second brightest star in the sky. A bright giant or supergiant. Often used for spacecraft navigation." },
            { name: "äº”è»ŠäºŒ (Capella)", temp: 4940, lum: 78.7, radius: 11.98, ra: "05h 16m 41s", dec: "+45Â° 59' 53\"", type: "G3III", desc: "å¾¡å¤«åº§æœ€äº®æ˜Ÿï¼Œå¯¦éš›ä¸Šæ˜¯ä¸€å€‹ç”±å…©é¡†é»ƒå·¨æ˜Ÿçµ„æˆçš„è¯æ˜Ÿç³»çµ±ã€‚", desc_en: "Brightest in Auriga. Actually a binary system of two yellow giant stars." },
            { name: "ç•¢å®¿äº” (Aldebaran)", temp: 3910, lum: 518, radius: 44.2, ra: "04h 35m 55s", dec: "+16Â° 30' 33\"", type: "K5III", desc: "ç´…å·¨æ˜Ÿï¼Œé‡‘ç‰›åº§ä¹‹çœ¼ã€‚å…ˆé©…è€…10è™Ÿæ¢æ¸¬å™¨æ­£æœå‘å®ƒçš„æ–¹å‘é£›è¡Œã€‚", desc_en: "Red giant, the Eye of Taurus. Pioneer 10 is heading in its general direction." },
            { name: "å¿ƒå®¿äºŒ (Antares)", temp: 3400, lum: 57500, radius: 680, ra: "16h 29m 24s", dec: "-26Â° 25' 55\"", type: "M1.5Iab-b", desc: "ç´…è¶…å·¨æ˜Ÿï¼Œå¤©è åº§çš„å¿ƒè‡Ÿã€‚åå­—æ„ç‚ºã€Œç«æ˜Ÿçš„å°æ‰‹ã€ï¼Œå› ç‚ºé¡è‰²èˆ‡ç«æ˜Ÿç›¸ä¼¼ã€‚", desc_en: "Red supergiant, heart of Scorpio. Name means 'Rival of Mars' due to its similar color." },
            { name: "åŒ—æ¥µæ˜Ÿ (Polaris)", temp: 6015, lum: 1260, radius: 37.5, ra: "02h 31m 49s", dec: "+89Â° 15' 51\"", type: "F7Ib", desc: "ç›®å‰çš„åŒ—æ¥µæ˜Ÿï¼Œæ˜¯ä¸€é¡†é€ çˆ¶è®Šæ˜Ÿï¼Œå¤©æ–‡å­¸å®¶ç”¨ä¾†æ¸¬é‡è·é›¢çš„é‡è¦å·¥å…·ã€‚", desc_en: "The current North Star. A Cepheid variable, an important tool for measuring distances." },
            { name: "å¤©æ´¥å›› (Deneb)", temp: 8525, lum: 196000, radius: 203, ra: "20h 41m 25s", dec: "+45Â° 16' 49\"", type: "A2Ia", desc: "æ¥µå…¶æ˜äº®çš„è—ç™½è¶…å·¨æ˜Ÿï¼Œä¹Ÿæ˜¯å·²çŸ¥æœ€æ˜äº®çš„æ†æ˜Ÿä¹‹ä¸€ã€‚å¦‚æœå®ƒåœ¨å¤©ç‹¼æ˜Ÿçš„ä½ç½®ï¼Œå°‡æ¯”æ»¿æœˆé‚„äº®ã€‚", desc_en: "Extremely bright blue-white supergiant. If placed where Sirius is, it would cast shadows like the full moon." },
            { name: "å·´ç´å¾·æ˜Ÿ (Barnard's Star)", temp: 3134, lum: 0.0035, radius: 0.196, ra: "17h 57m 48s", dec: "+04Â° 41' 36\"", type: "M4V", desc: "ä¸€é¡†éå¸¸å¤è€çš„ç´…çŸ®æ˜Ÿï¼Œä»¥å…¶æ¥µé«˜çš„è‡ªè¡Œé‹å‹•ï¼ˆåœ¨å¤©çƒä¸Šç§»å‹•é€Ÿåº¦å¿«ï¼‰è€Œèåã€‚", desc_en: "Very old red dwarf. Famous for having the highest proper motion of any star." },
            { name: "å—é–€äºŒ A (Alpha Centauri A)", temp: 5790, lum: 1.519, radius: 1.22, ra: "14h 39m 36s", dec: "-60Â° 50' 02\"", type: "G2V", desc: "æœ€æ¥è¿‘å¤ªé™½ç³»çš„æ†æ˜Ÿç³»çµ±ä¸»æ˜Ÿï¼Œæ€§è³ªèˆ‡å¤ªé™½éå¸¸ç›¸ä¼¼ã€‚", desc_en: "Main star of the closest star system to us. Very similar to the Sun." },
            { name: "åƒå®¿äº” (Bellatrix)", temp: 21800, lum: 9211, radius: 5.7, ra: "05h 25m 07s", dec: "+06Â° 20' 58\"", type: "B2III", desc: "çµæˆ¶åº§çš„ã€Œäºé¦¬éœå¥³æˆ°å£«ã€ï¼Œä¸€é¡†ç†¾ç†±çš„è—è‰²å·¨æ˜Ÿã€‚", desc_en: "The 'Amazon Star' of Orion. A hot blue giant." },
            { name: "è»’è½…åå›› (Regulus)", temp: 12460, lum: 288, radius: 3.09, ra: "10h 08m 22s", dec: "+11Â° 58' 01\"", type: "B7V", desc: "ç…å­åº§æœ€äº®æ˜Ÿã€‚å®ƒæ—‹è½‰æ¥µå¿«ï¼Œå½¢ç‹€è®Šæˆæ˜é¡¯çš„æ‰çƒé«”ã€‚", desc_en: "Brightest in Leo. Rotates so fast it is significantly oblate (flattened)." },
            { name: "Procyon B", temp: 7740, lum: 0.00049, radius: 0.012, ra: "07h 39m 18s", dec: "+05Â° 13' 29\"", type: "DQZ", desc: "å—æ²³ä¸‰çš„ä¼´æ˜Ÿï¼Œä¹Ÿæ˜¯ä¸€é¡†é»¯æ·¡çš„ç™½çŸ®æ˜Ÿã€‚", desc_en: "Companion to Procyon A. A faint white dwarf." },
            { name: "Spica (è§’å®¿ä¸€)", temp: 22400, lum: 12100, radius: 7.4, ra: "13h 25m 11s", dec: "-11Â° 09' 40\"", type: "B1III-IV", desc: "å®¤å¥³åº§æœ€äº®æ˜Ÿï¼Œæ˜¯ä¸€é¡†å¯†è¿‘é›™æ˜Ÿç³»çµ±ï¼Œå› æ½®æ±åŠ›è€Œè®Šå½¢ã€‚", desc_en: "Brightest in Virgo. A close binary system distorted by tidal forces." },
            
            { name: "æ°´å§”ä¸€ (Achernar)", temp: 15000, lum: 3150, radius: 7.3, ra: "01h 37m 42s", dec: "-57Â° 14' 12\"", type: "B3Vp", desc: "æ³¢æ±Ÿåº§æœ€äº®æ˜Ÿï¼Œæ—‹è½‰é€Ÿåº¦æ¥µå¿«ï¼Œæ˜¯æœ€æ‰çš„æ†æ˜Ÿä¹‹ä¸€ã€‚", desc_en: "Brightest in Eridanus. Spins so fast it is one of the flattest stars known." },
            { name: "ç‰›éƒæ˜Ÿ (Altair)", temp: 7550, lum: 10.6, radius: 1.79, ra: "19h 50m 47s", dec: "+08Â° 52' 06\"", type: "A7V", desc: "å¤©é·¹åº§æœ€äº®æ˜Ÿï¼Œå¤å­£å¤§ä¸‰è§’ä¹‹ä¸€ï¼Œè·é›¢åœ°çƒåƒ…16.7å…‰å¹´ã€‚", desc_en: "Brightest in Aquila. Part of the Summer Triangle. Only 16.7 ly away." },
            { name: "åŒ—è½å¸«é–€ (Fomalhaut)", temp: 8590, lum: 16.6, radius: 1.84, ra: "22h 57m 39s", dec: "-29Â° 37' 20\"", type: "A3V", desc: "å—é­šåº§æœ€äº®æ˜Ÿï¼Œå‘¨åœæ“æœ‰è‘—åçš„å¡µåŸƒç›¤å’Œç³»å¤–è¡Œæ˜Ÿã€‚", desc_en: "Brightest in Piscis Austrinus. Famous for its dust ring and exoplanet." },
            { name: "å—æ²³ä¸‰ A (Procyon A)", temp: 6530, lum: 6.93, radius: 2.04, ra: "07h 39m 18s", dec: "+05Â° 13' 29\"", type: "F5IV-V", desc: "å°çŠ¬åº§æœ€äº®æ˜Ÿï¼Œå³å°‡é›¢é–‹ä¸»åºå¸¶é€²å…¥æ¬¡å·¨æ˜Ÿéšæ®µã€‚", desc_en: "Brightest in Canis Minor. Leaving the main sequence to become a subgiant." },
            { name: "å¤©å€‰äº” (Tau Ceti)", temp: 5344, lum: 0.52, radius: 0.79, ra: "01h 44m 04s", dec: "-15Â° 56' 14\"", type: "G8V", desc: "é¯¨é­šåº§çš„ä¸€é¡†ç©©å®šé»ƒçŸ®æ˜Ÿï¼Œå› ç‚ºæ€§è³ªèˆ‡å¤ªé™½ç›¸ä¼¼ï¼Œå¸¸æ˜¯æœå°‹å¤–æ˜Ÿç”Ÿå‘½çš„ç›®æ¨™ã€‚", desc_en: "Stable yellow dwarf in Cetus. Similar to Sun, popular target for SETI." },
            { name: "å¤©è‹‘å›› (Epsilon Eridani)", temp: 5084, lum: 0.34, radius: 0.73, ra: "03h 32m 55s", dec: "-09Â° 27' 29\"", type: "K2V", desc: "æ³¢æ±Ÿåº§çš„å¹´è¼•æ©™çŸ®æ˜Ÿï¼Œè·é›¢æˆ‘å€‘éå¸¸è¿‘ï¼Œæ“æœ‰è¡Œæ˜Ÿç³»çµ±ã€‚", desc_en: "Young orange dwarf in Eridanus. Very close and hosts a planetary system." },
            { name: "è¼¦é“å¢ä¸ƒ A (Albireo A)", temp: 4080, lum: 1200, radius: 69, ra: "19h 30m 43s", dec: "+27Â° 57' 34\"", type: "K3II", desc: "å¤©éµåº§ç¾éº—çš„é›™æ˜Ÿç³»çµ±ä¸»æ˜Ÿï¼Œå‘ˆç¾é‡‘é»ƒè‰²ã€‚", desc_en: "Golden primary of the beautiful double star Albireo in Cygnus." },
            { name: "61 Cygni A", temp: 4530, lum: 0.15, radius: 0.66, ra: "21h 06m 53s", dec: "+38Â° 44' 57\"", type: "K5V", desc: "å¤©éµåº§çš„è‘—åé›™æ˜Ÿï¼Œæ˜¯äººé¡æ­·å²ä¸Šç¬¬ä¸€é¡†è¢«æ¸¬é‡å‡ºè·é›¢çš„æ†æ˜Ÿã€‚", desc_en: "Famous binary in Cygnus. First star to have its distance measured." },
            { name: "61 Cygni B", temp: 4040, lum: 0.085, radius: 0.59, ra: "21h 06m 55s", dec: "+38Â° 44' 29\"", type: "K7V", desc: "61 Cygni çš„ä¼´æ˜Ÿï¼Œæ¯”ä¸»æ˜Ÿç¨æš—ä¸”ç´…ã€‚", desc_en: "Companion to 61 Cygni A. Fainter and redder." },
            { name: "Lacaille 9352", temp: 3690, lum: 0.033, radius: 0.47, ra: "23h 05m 52s", dec: "-35Â° 51' 11\"", type: "M0.5V", desc: "å—é­šåº§çš„ä¸€é¡†ç´…çŸ®æ˜Ÿï¼Œä¹Ÿæ˜¯è·é›¢å¤ªé™½ç³»æœ€è¿‘çš„æ†æ˜Ÿä¹‹ä¸€ã€‚", desc_en: "Red dwarf in Piscis Austrinus. One of the closest stars." },
            { name: "Gliese 1", temp: 3400, lum: 0.012, radius: 0.35, ra: "00h 05m 24s", dec: "-37Â° 21' 26\"", type: "M1.5V", desc: "ä½æ–¼ç‰å¤«åº§çš„ç´…çŸ®æ˜Ÿï¼Œé„°è¿‘å¤ªé™½ç³»ã€‚", desc_en: "Red dwarf in Sculptor, near the Solar System." },
            { name: "åŒ—æ²³ä¸‰ (Pollux)", temp: 4666, lum: 43, radius: 8.8, ra: "07h 45m 18s", dec: "+28Â° 01' 34\"", type: "K0III", desc: "é›™å­åº§çš„ä¸€é¡†ç´…å·¨æ˜Ÿï¼Œæ˜¯å·²çŸ¥æ“æœ‰è¡Œæ˜Ÿçš„æœ€äº®æ†æ˜Ÿä¹‹ä¸€ã€‚", desc_en: "Red giant in Gemini. One of the brightest stars known to have a planet." },
            { name: "é¦¬è…¹ä¸€ (Hadar)", temp: 25000, lum: 112000, radius: 13, ra: "14h 03m 49s", dec: "-60Â° 22' 22\"", type: "B1III", desc: "åŠäººé¦¬åº§ç¬¬äºŒäº®æ˜Ÿï¼Œæ˜¯ä¸€é¡†è—ç™½å·¨æ˜Ÿã€‚", desc_en: "Second brightest in Centaurus. A blue-white giant." },
            { name: "é–‹é™½æ˜Ÿ (Mizar)", temp: 9000, lum: 33, radius: 2.4, ra: "13h 23m 55s", dec: "+54Â° 55' 31\"", type: "A2V", desc: "åŒ—æ–—ä¸ƒæ˜Ÿä¹‹ä¸€ï¼Œæ˜¯è‘—åçš„å…‰å­¸é›™æ˜Ÿï¼ˆèˆ‡è¼”æ˜Ÿ Alcorï¼‰ã€‚", desc_en: "Star in the Big Dipper. Famous optical double with Alcor." },
            { name: "ç‹è‰¯å›› (Schedar)", temp: 4530, lum: 676, radius: 42, ra: "00h 40m 30s", dec: "+56Â° 32' 14\"", type: "K0IIIa", desc: "ä»™ååº§çš„æ©™è‰²å·¨æ˜Ÿã€‚", desc_en: "Orange giant in Cassiopeia." },
            
            // --- Generic Stars ---
            { name: "Generic B-Type", temp: 18000, lum: 2000, radius: 5, ra: "--", dec: "--", type: "B5V", desc: "å…¸å‹ B å‹ä¸»åºæ˜Ÿã€‚", desc_en: "Typical B-type main sequence star." },
            { name: "Generic A-Type", temp: 8500, lum: 20, radius: 1.8, ra: "--", dec: "--", type: "A5V", desc: "å…¸å‹ A å‹ä¸»åºæ˜Ÿã€‚", desc_en: "Typical A-type main sequence star." },
            { name: "Generic F-Type", temp: 7000, lum: 4, radius: 1.4, ra: "--", dec: "--", type: "F2V", desc: "å…¸å‹ F å‹ä¸»åºæ˜Ÿã€‚", desc_en: "Typical F-type main sequence star." },
            { name: "Generic G-Type", temp: 5500, lum: 0.8, radius: 0.9, ra: "--", dec: "--", type: "G8V", desc: "å…¸å‹ G å‹ä¸»åºæ˜Ÿã€‚", desc_en: "Typical G-type main sequence star." },
            { name: "Generic K-Type", temp: 4800, lum: 0.4, radius: 0.8, ra: "--", dec: "--", type: "K2V", desc: "å…¸å‹ K å‹ä¸»åºæ˜Ÿã€‚", desc_en: "Typical K-type main sequence star." },
            { name: "Generic K-Late", temp: 4000, lum: 0.1, radius: 0.6, ra: "--", dec: "--", type: "K8V", desc: "æ™šæœŸ K å‹ä¸»åºæ˜Ÿã€‚", desc_en: "Late K-type main sequence star." },
            { name: "Generic M-Early", temp: 3500, lum: 0.05, radius: 0.4, ra: "--", dec: "--", type: "M2V", desc: "æ—©æœŸ M å‹ç´…çŸ®æ˜Ÿã€‚", desc_en: "Early M-type red dwarf." }
        ];

        // --- Generators (Updated with English Descriptions) ---
        function generateBackgroundStars(count) {
            const newStars = [];
            for(let i=0; i<count; i++) {
                const r = Math.random();
                let temp;
                if (r < 0.6) temp = 2000 + Math.random() * 3500;
                else if (r < 0.85) temp = 5500 + Math.random() * 4500;
                else temp = 10000 + Math.random() * 20000;

                const logT_Sun = Math.log10(5778);
                const logT = Math.log10(temp);
                let slope = 4.8;
                if(temp < 4000) slope = 5.5;
                const logL = slope * (logT - logT_Sun);
                const noise = (Math.random() - 0.5) * 0.8; 
                const lum = Math.pow(10, logL + noise);
                const radius = Math.sqrt(lum) / Math.pow(temp/5778, 2);

                newStars.push({
                    name: `HIP ${Math.floor(Math.random()*100000)}`,
                    temp: Math.round(temp),
                    lum: parseFloat(lum.toFixed(5)),
                    radius: parseFloat(radius.toFixed(3)),
                    ra: "--", dec: "--",
                    type: "MS (Background)",
                    desc: "èƒŒæ™¯ä¸»åºæ˜Ÿ (æ¨¡æ“¬è§€æ¸¬æ•¸æ“š)ï¼Œå±•ç¤ºäº†æ†æ˜Ÿæ¼”åŒ–çš„ä¸»è¦è·¯å¾‘ã€‚",
                    desc_en: "Background main sequence star (simulated data), showing the main path of stellar evolution."
                });
            }
            return newStars;
        }

        function generateGiants(count, isSupergiant = false) {
            const newStars = [];
            for(let i=0; i<count; i++) {
                const temp = 3000 + Math.random() * 2000;
                let lum, typeLabel, descLabel, descLabelEn, typeLabelEn;

                if (isSupergiant) {
                    const logL = 4 + Math.random() * 1.7; 
                    lum = Math.pow(10, logL);
                    typeLabel = "Supergiant (I)";
                    descLabel = "èƒŒæ™¯ç´…è¶…å·¨æ˜Ÿï¼Œé€™é¡æ†æ˜Ÿé«”ç©å·¨å¤§ï¼Œå£½å‘½å°‡ç›¡ã€‚";
                    descLabelEn = "Background red supergiant. Massive star nearing the end of its life.";
                } else {
                    const logL = 1.7 + Math.random() * 1.6;
                    lum = Math.pow(10, logL);
                    typeLabel = "Giant (III)";
                    descLabel = "èƒŒæ™¯ç´…å·¨æ˜Ÿï¼Œé€™æ˜¯åƒå¤ªé™½é€™æ¨£çš„æ†æ˜Ÿåœ¨è€—ç›¡æ°«ç‡ƒæ–™å¾Œçš„æ¼”åŒ–éšæ®µã€‚";
                    descLabelEn = "Background red giant. The evolutionary stage of a sun-like star after exhausting its hydrogen.";
                }

                const radius = Math.sqrt(lum) / Math.pow(temp/5778, 2);

                newStars.push({
                    name: `HIP ${Math.floor(Math.random()*100000)}`,
                    temp: Math.round(temp),
                    lum: parseFloat(lum.toFixed(2)),
                    radius: parseFloat(radius.toFixed(2)),
                    ra: "--", dec: "--",
                    type: typeLabel,
                    desc: descLabel,
                    desc_en: descLabelEn
                });
            }
            return newStars;
        }

        function generateWhiteDwarfs(count) {
            const newStars = [];
            for(let i=0; i<count; i++) {
                const temp = 8000 + Math.random() * 22000;
                const logT = Math.log10(temp);
                const logL = 3 * logT - 13 + (Math.random() - 0.5); 
                const lum = Math.pow(10, logL);
                const radius = Math.sqrt(lum) / Math.pow(temp/5778, 2);

                newStars.push({
                    name: `WD ${Math.floor(Math.random()*100000)}`,
                    temp: Math.round(temp),
                    lum: parseFloat(lum.toFixed(5)),
                    radius: parseFloat(radius.toFixed(4)),
                    ra: "--", dec: "--",
                    type: "White Dwarf (VII)",
                    desc: "èƒŒæ™¯ç™½çŸ®æ˜Ÿï¼Œæ†æ˜Ÿæ­»äº¡å¾Œç•™ä¸‹çš„ç·»å¯†æ ¸å¿ƒï¼Œé«”ç©é€šå¸¸èˆ‡åœ°çƒç›¸ç•¶ã€‚",
                    desc_en: "Background white dwarf. The dense core remnant of a dead star, roughly the size of Earth."
                });
            }
            return newStars;
        }

        // ç”Ÿæˆå„é¡æ†æ˜Ÿä¸¦åŠ å…¥æ•¸æ“šé›†
        const backgroundMS = generateBackgroundStars(300);
        const backgroundGiants = generateGiants(60); 
        const backgroundSuperGiants = generateGiants(20, true);
        const backgroundWhiteDwarfs = generateWhiteDwarfs(40);

        starsData.push(...backgroundMS, ...backgroundGiants, ...backgroundSuperGiants, ...backgroundWhiteDwarfs);

        // --- è¿½è¸ªç•¶å‰é¸æ“‡çš„è®Šé‡ ---
        let selectedStarIndex = -1;
        const sunIndex = starsData.findIndex(s => s.name.includes("å¤ªé™½"));
        if (sunIndex !== -1) {
            selectedStarIndex = sunIndex;
        }

        // --- Helper Functions ---
        function getColorFromTemp(temp) {
            if (temp >= 30000) return 'rgba(157, 180, 255, 0.9)'; // Blue
            if (temp >= 10000) return 'rgba(178, 200, 255, 0.9)'; // Blue-White
            if (temp >= 7500)  return 'rgba(255, 255, 255, 0.9)'; // White
            if (temp >= 6000)  return 'rgba(255, 244, 232, 0.9)'; // Yellow-White
            if (temp >= 5200)  return 'rgba(255, 235, 59, 0.9)';   // Yellow
            if (temp >= 3700)  return 'rgba(255, 152, 0, 0.9)';   // Orange
            return 'rgba(255, 87, 34, 0.9)';                      // Red
        }

        // --- Chart Configuration ---
        const ctx = document.getElementById('hrChart').getContext('2d');
        const chartData = starsData.map(star => ({ x: star.temp, y: star.lum, starInfo: star }));
        const backgroundColors = starsData.map(star => getColorFromTemp(star.temp));

        const sunLinePlugin = {
            id: 'sunLine',
            afterDraw: (chart) => {
                const ctx = chart.ctx;
                const yAxis = chart.scales.y;
                const xAxis = chart.scales.x;
                const yPos = yAxis.getPixelForValue(1);
                if (yPos >= yAxis.top && yPos <= yAxis.bottom) {
                    ctx.save();
                    ctx.beginPath();
                    ctx.strokeStyle = 'rgba(255, 255, 255, 0.8)';
                    ctx.lineWidth = 2;
                    ctx.moveTo(xAxis.left, yPos);
                    ctx.lineTo(xAxis.right, yPos);
                    ctx.stroke();
                    ctx.fillStyle = 'rgba(255, 255, 255, 0.9)';
                    ctx.font = 'bold 12px "Noto Sans TC"';
                    ctx.textAlign = 'right';
                    ctx.textBaseline = 'bottom';
                    ctx.fillText('1 Lâ˜‰ (Sun)', xAxis.right - 8, yPos - 4);
                    ctx.restore();
                }
            }
        };

        const hrChart = new Chart(ctx, {
            type: 'scatter',
            data: {
                datasets: [{
                    label: 'Stars',
                    data: chartData,
                    backgroundColor: backgroundColors,
                    borderColor: (context) => (context.dataIndex === selectedStarIndex) ? '#ffffff' : 'rgba(255,255,255,0.3)',
                    borderWidth: (context) => (context.dataIndex === selectedStarIndex) ? 3 : 1,
                    pointRadius: (context) => {
                        const star = context.raw?.starInfo;
                        if(!star) return 5;
                        let size = Math.log10(star.radius) * 2 + 5; 
                        return Math.max(3, Math.min(size, 12));
                    },
                    pointHoverRadius: 15,
                    pointHoverBorderWidth: 3,
                    pointHoverBorderColor: '#fff'
                }]
            },
            plugins: [sunLinePlugin],
            options: {
                responsive: true,
                maintainAspectRatio: false,
                layout: { padding: 10 },
                scales: {
                    x: {
                        type: 'logarithmic',
                        position: 'bottom',
                        reverse: true,
                        title: {
                            display: true,
                            text: i18n[currentLang].axisX, // Initial text
                            color: '#94a3b8',
                            font: { size: 14 }
                        },
                        ticks: {
                            color: '#64748b',
                            autoSkip: false,
                            maxRotation: 0,
                            callback: function(value) {
                                const targetValues = [2000, 3000, 4000, 6000, 7000, 10000, 20000, 30000];
                                return targetValues.includes(value) ? value : '';
                            }
                        },
                        grid: { color: '#334155' },
                        min: 2000, max: 30000,
                        afterBuildTicks: (axis) => {
                            axis.ticks = [2000, 3000, 4000, 6000, 7000, 10000, 20000, 30000].map(v => ({ value: v }));
                        }
                    },
                    y: {
                        type: 'logarithmic',
                        title: {
                            display: true,
                            text: i18n[currentLang].axisY, // Initial text
                            color: '#94a3b8',
                            font: { size: 14 }
                        },
                        ticks: {
                            color: '#64748b',
                            callback: (value) => [100000, 1000, 10, 1, 0.1, 0.001].includes(value) ? value.toString() : null
                        },
                        grid: { color: '#334155' },
                        min: 0.0001, max: 1000000
                    }
                },
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        backgroundColor: 'rgba(15, 23, 42, 0.9)',
                        titleColor: '#fff',
                        bodyColor: '#cbd5e1',
                        borderColor: '#475569',
                        borderWidth: 1,
                        callbacks: {
                            label: (context) => context.raw.starInfo.name,
                            afterLabel: (context) => `Type: ${context.raw.starInfo.type}`
                        }
                    }
                },
                onClick: (event, elements) => {
                    if (elements.length > 0) {
                        const index = elements[0].index;
                        selectedStarIndex = index;
                        hrChart.update();
                        showStarDetails(chartData[index].starInfo);
                    }
                }
            }
        });

        // --- DOM Logic ---
        
        function toggleInfoModal(show) {
            const modal = document.getElementById('infoModal');
            // Update modal content based on current language before showing
            if(show) {
                document.getElementById('modal-title').innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z" />
                    </svg>
                    ${i18n[currentLang].modalTitle}`;
                document.getElementById('modal-content').innerHTML = i18n[currentLang].modalBody;
                document.getElementById('btn-close').innerText = i18n[currentLang].btnClose;
                
                modal.classList.remove('hidden');
                modal.onclick = (e) => (e.target === modal) ? toggleInfoModal(false) : null;
            } else {
                modal.classList.add('hidden');
            }
        }

        // New function for Lifecycle Modal
        function toggleLifecycleModal(show) {
            const modal = document.getElementById('lifecycleModal');
            if(show) {
                // Update text
                document.getElementById('lifecycle-title').innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-indigo-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                         <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                    </svg>
                    ${i18n[currentLang].modalLifecycleTitle}`;
                document.getElementById('lifecycle-content').innerHTML = i18n[currentLang].modalLifecycleBody;
                document.getElementById('btn-close-lifecycle').innerText = i18n[currentLang].btnClose;

                modal.classList.remove('hidden');
                modal.onclick = (e) => (e.target === modal) ? toggleLifecycleModal(false) : null;
            } else {
                modal.classList.add('hidden');
            }
        }

        // Language Toggle Function
        function toggleLanguage() {
            currentLang = currentLang === 'zh' ? 'en' : 'zh';
            const text = i18n[currentLang];

            // 1. Update Static UI
            document.getElementById('nav-subtitle').innerText = text.subtitle;
            document.getElementById('nav-version').innerText = text.version;
            document.getElementById('btn-explain-text').innerText = text.btnExplain;
            document.getElementById('btn-lifecycle-text').innerText = text.btnLifecycle;
            
            document.getElementById('legend-ms').innerText = text.legendMS;
            document.getElementById('legend-giant').innerText = text.legendGiant;
            document.getElementById('legend-wd').innerText = text.legendWD;
            document.getElementById('chart-tip').innerText = text.chartTip;

            document.getElementById('empty-text-1').innerText = text.empty1;
            document.getElementById('empty-text-2').innerText = text.empty2;

            document.getElementById('lbl-spec-type').innerText = text.lblSpecType;
            document.getElementById('lbl-phys-prop').innerText = text.lblPhysProp;
            document.getElementById('lbl-temp').innerText = text.lblTemp;
            document.getElementById('lbl-lum').innerText = text.lblLum;
            document.getElementById('lbl-rad').innerText = text.lblRad;
            document.getElementById('lbl-color').innerText = text.lblColor;
            
            document.getElementById('lbl-desc').innerText = text.lblDesc;
            document.getElementById('lbl-visual').innerText = text.lblVisual;

            // 2. Update Chart Axes
            hrChart.options.scales.x.title.text = text.axisX;
            hrChart.options.scales.y.title.text = text.axisY;
            hrChart.update();

            // 3. Update Current Star Details (if selected)
            if (selectedStarIndex !== -1) {
                showStarDetails(starsData[selectedStarIndex]);
            }
        }

        function showStarDetails(star) {
            document.getElementById('empty-state').classList.add('hidden');
            document.getElementById('star-details').classList.remove('hidden');

            document.getElementById('star-name').innerText = star.name; // Names are universal enough or bilingual in source
            document.getElementById('star-type').innerText = star.type;
            document.getElementById('star-temp').innerText = star.temp.toLocaleString();
            document.getElementById('star-lum').innerText = star.lum.toLocaleString();
            document.getElementById('star-radius').innerText = star.radius;
            
            let bv = 0;
            if(star.temp > 30000) bv = -0.3;
            else if(star.temp > 10000) bv = 0.0;
            else if(star.temp > 6000) bv = 0.4;
            else if(star.temp > 5000) bv = 0.65;
            else if(star.temp > 3500) bv = 1.4;
            else bv = 1.8;
            document.getElementById('star-bv').innerText = bv.toFixed(2);
            
            // Choose description based on language
            const desc = currentLang === 'en' && star.desc_en ? star.desc_en : star.desc;
            document.getElementById('star-desc').innerText = desc;

            const visual = document.getElementById('star-visual');
            visual.style.backgroundColor = getColorFromTemp(star.temp);
            
            let visualSize = 24;
            if (star.radius > 1) {
                visualSize = 24 + Math.min(Math.log2(star.radius) * 10, 60); 
            } else {
                visualSize = Math.max(10, 24 - Math.abs(Math.log2(star.radius) * 5)); 
            }
            
            visual.style.width = `${visualSize}px`;
            visual.style.height = `${visualSize}px`;
            visual.style.boxShadow = `0 0 ${visualSize/1.5}px ${getColorFromTemp(star.temp)}`;
        }

        // Init
        window.onload = function() {
            const sunData = starsData.find(s => s.name.includes("å¤ªé™½"));
            if (sunData) {
                showStarDetails(sunData);
                hrChart.update();
            }
        };

    </script>
</body>
</html>